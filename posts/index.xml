<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Posts on graeme phillips posting</title>
    <link>https://graemephi.github.io/posts/</link>
    <description>Recent content in Posts on graeme phillips posting</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Sat, 14 Dec 2019 18:34:03 +0100</lastBuildDate>
    
        <atom:link href="https://graemephi.github.io/posts/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>The Discrete Fourier Transform, But With Triangles</title>
      <link>https://graemephi.github.io/posts/triangle-dft/</link>
      <pubDate>Sat, 14 Dec 2019 18:34:03 +0100</pubDate>
      
      <guid>https://graemephi.github.io/posts/triangle-dft/</guid>
      <description>&lt;p&gt;Here’s something I’ve been wondering about lately: what happens if you replace all the sine waves in the fourier transform with triangle waves? If you are like me and would like to play around with such a thing, this post has a method to get a representation of a signal as scaled-and-shifted &lt;em&gt;band-limited&lt;/em&gt; triangle waves in &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.02778em;&#34;&gt;O&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop&#34;&gt;lo&lt;span style=&#34;margin-right:0.01389em;&#34;&gt;g&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; time. This is fast enough that we can compute first and ask questions about what it’s good for later (I’ve yet to find anything). Actually, the stuff in this post will work for any periodic function, not just triangle waves, but this was the idea that motivated me to figure this out.&lt;/p&gt;
&lt;p&gt;To get more precise in what I’m trying to do here, here’s what I want. The DFT takes a signal made up of sine waves with amplitudes &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.58056em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathdefault mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;, phases &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.84444em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.02778em;&#34;&gt;θ&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathdefault mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;, and integer frequencies &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.69444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;, and produces a signal that has the value &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.9991079999999999em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathdefault mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8491079999999999em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathdefault mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathdefault mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;θ&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3448em;&#34;&gt;&lt;span style=&#34;top:-2.3487714285714287em;margin-left:-0.02778em;margin-right:0.07142857142857144em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mathdefault mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15122857142857138em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; at &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.69444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;. I want a transform that does the same for triangle waves.&lt;/p&gt;
&lt;p&gt;I had a few bad starts on this–for one thing, triangle waves are not orthogonal to each other at all–but it all came together when I asked the following question: What is a cosine wave given as a sum of triangle waves?&lt;/p&gt;
&lt;p&gt;First, we need a definition of a triangle wave. With &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.07153em;&#34;&gt;K&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; being the number of harmonics and &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.77777em;vertical-align:-0.08333em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.64444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;,&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord text&#34;&gt;&lt;span class=&#34;mord&#34;&gt;tri&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:3.1304490000000005em;vertical-align:-1.302113em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop op-limits&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.8283360000000002em;&#34;&gt;&lt;span style=&#34;top:-1.8478869999999998em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathdefault mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.0500049999999996em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&#34;mop op-symbol large-op&#34;&gt;∑&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-4.300005em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathdefault mtight&#34; style=&#34;margin-right:0.07153em;&#34;&gt;K&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;−&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.302113em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.32144em;&#34;&gt;&lt;span style=&#34;top:-2.314em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.740108em;&#34;&gt;&lt;span style=&#34;top:-2.9890000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.686em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop&#34;&gt;cos&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.03588em;&#34;&gt;π&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;I’ve adapted&lt;a href=&#34;#fn1&#34; class=&#34;footnote-ref&#34; id=&#34;fnref1&#34; role=&#34;doc-noteref&#34;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/a&gt; this from the first of many definitions of a triangle wave on &lt;a href=&#34;https://en.wikipedia.org/wiki/Triangle_wave&#34;&gt;Wikipedia&lt;/a&gt;, where it’s presented without justification or citation. Personally, I don’t understand where it comes from, but it is pretty much the frequency domain represention of a triangle wave and that’s all we need. For the rest of this post, I’m going to leave &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.07153em;&#34;&gt;K&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; implicitly defined as the largest value it can take without introducing aliasing in its current context.&lt;/p&gt;
&lt;p&gt;For now, we just want to think about finding the &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.83333em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.07847em;&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathdefault mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; that gives us&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop&#34;&gt;cos&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.03588em;&#34;&gt;π&lt;/span&gt;&lt;span class=&#34;mord text&#34;&gt;&lt;span class=&#34;mord textbf&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:3.1304490000000005em;vertical-align:-1.302113em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop op-limits&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.8283360000000002em;&#34;&gt;&lt;span style=&#34;top:-1.8478869999999998em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathdefault mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.0500049999999996em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&#34;mop op-symbol large-op&#34;&gt;∑&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-4.300005em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathdefault mtight&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;−&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.302113em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.07847em;&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathdefault mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord text&#34;&gt;&lt;span class=&#34;mord&#34;&gt;tri&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;mord text&#34;&gt;&lt;span class=&#34;mord textbf&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;where &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord text&#34;&gt;&lt;span class=&#34;mord textbf&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;. Restricting ourselves to band-limited triangle waves gives us the fact that the lowest frequency of &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord text&#34;&gt;&lt;span class=&#34;mord&#34;&gt;tri&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;mord text&#34;&gt;&lt;span class=&#34;mord textbf&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; is &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.69444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;. Then &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord text&#34;&gt;&lt;span class=&#34;mord&#34;&gt;tri&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord text&#34;&gt;&lt;span class=&#34;mord textbf&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; with &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.69444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.64444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; is the only member of our series that is not orthogonal to &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop&#34;&gt;cos&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.03588em;&#34;&gt;π&lt;/span&gt;&lt;span class=&#34;mord text&#34;&gt;&lt;span class=&#34;mord textbf&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;, so we know &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.83333em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.07847em;&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.30110799999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.64444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;. But this introduces odd harmonics all the way up, and so the coefficient of the next odd triangle wave at &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.69444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.64444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; must use its lowest frequency to subtract out the first odd harmonic of the triangle wave at &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.69444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.64444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;, so &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.83333em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.07847em;&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.30110799999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;−&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;9&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;. This adds yet more harmonics for later triangle waves to clean up. We keep going like this until we’ve accounted for all &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; triangle waves.&lt;/p&gt;
&lt;p&gt;If that was too quick, here it is in pictures. The frequency domain representation is overlaid on top.&lt;/p&gt;

&lt;img src=&#34;https://graemephi.github.io/posts/triangle-dft/cosine.png&#34;/&gt;


&lt;p&gt;It’s not hard to see that this logic mostly works for arbitrary functions, too. We lose the orthogonality to kick off the process, but the whole point of the DFT is that sines and cosines form an orthogonal basis, so we only need orthogonality to the lowest frequency. As we go, we successively remove frequencies, so there is always a new lowest frequency to remove&lt;a href=&#34;#fn2&#34; class=&#34;footnote-ref&#34; id=&#34;fnref2&#34; role=&#34;doc-noteref&#34;&gt;&lt;sup&gt;2&lt;/sup&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Before we can implement this we also need to handle the phase of each frequency component. When we see &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.9991079999999999em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathdefault mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8491079999999999em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathdefault mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathdefault mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;θ&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3448em;&#34;&gt;&lt;span style=&#34;top:-2.3487714285714287em;margin-left:-0.02778em;margin-right:0.07142857142857144em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mathdefault mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15122857142857138em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; at &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.69444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;, we need to align the phase of the lowest frequency of &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord text&#34;&gt;&lt;span class=&#34;mord&#34;&gt;tri&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; with &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.84444em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.02778em;&#34;&gt;θ&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathdefault mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;. We’re working in the frequency domain, so we need this thing from the shift theorem&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.0879999999999999em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.07847em;&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.151392em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathdefault mtight&#34;&gt;n&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.938em;&#34;&gt;&lt;span style=&#34;top:-3.113em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;−&lt;/span&gt;&lt;span class=&#34;mord mathdefault mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;mord mathdefault mtight&#34; style=&#34;margin-right:0.03588em;&#34;&gt;π&lt;/span&gt;&lt;span class=&#34;mord mathdefault mtight&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;ℓ&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;mord mathdefault mtight&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;to apply a shift of &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.69444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;ℓ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;. In our case, &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.07847em;&#34;&gt;X&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; contains the &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.064108em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8141079999999999em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; factors of the current triangle wave. We just need to know &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.69444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;ℓ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;. Now, the lowest frequency of &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord text&#34;&gt;&lt;span class=&#34;mord&#34;&gt;tri&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; is &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.83333em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.07847em;&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathdefault mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;, so we want to choose &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.69444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;ℓ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; to satisfy&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.0879999999999999em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.07847em;&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.151392em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathdefault mtight&#34;&gt;n&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.938em;&#34;&gt;&lt;span style=&#34;top:-3.113em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;−&lt;/span&gt;&lt;span class=&#34;mord mathdefault mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;mord mathdefault mtight&#34; style=&#34;margin-right:0.03588em;&#34;&gt;π&lt;/span&gt;&lt;span class=&#34;mord mathdefault mtight&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;ℓ&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;mord mathdefault mtight&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.0491079999999997em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.07847em;&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathdefault mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8991079999999998em;&#34;&gt;&lt;span style=&#34;top:-3.113em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathdefault mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathdefault mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;θ&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3448em;&#34;&gt;&lt;span style=&#34;top:-2.3487714285714287em;margin-left:-0.02778em;margin-right:0.07142857142857144em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mathdefault mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15122857142857138em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:1em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord text&#34;&gt;&lt;span class=&#34;mord&#34;&gt;if &lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.69444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;So&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.84444em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;ℓ&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathdefault mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.04633em;vertical-align:-0.686em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;−&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.36033em;&#34;&gt;&lt;span style=&#34;top:-2.314em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.03588em;&#34;&gt;π&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.686em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.32144em;&#34;&gt;&lt;span style=&#34;top:-2.314em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.686em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.02778em;&#34;&gt;θ&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathdefault mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;This part seemed obvious when I was just turning ideas in my head into code but now that I write it out like this I’m not so sure.&lt;/p&gt;
&lt;p&gt;This is all we need to find the &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.83333em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.07847em;&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathdefault mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; in&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.10764em;&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord text&#34;&gt;&lt;span class=&#34;mord textbf&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:3.1304490000000005em;vertical-align:-1.302113em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop op-limits&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.8283360000000002em;&#34;&gt;&lt;span style=&#34;top:-1.8478869999999998em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathdefault mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.0500049999999996em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&#34;mop op-symbol large-op&#34;&gt;∑&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-4.300005em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathdefault mtight&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;−&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.302113em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;∣&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.07847em;&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathdefault mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;∣&lt;/span&gt;&lt;span class=&#34;mord text&#34;&gt;&lt;span class=&#34;mord&#34;&gt;tri&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;mord text&#34;&gt;&lt;span class=&#34;mord textbf&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.00744em;vertical-align:-0.686em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.32144em;&#34;&gt;&lt;span style=&#34;top:-2.314em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.03588em;&#34;&gt;π&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.686em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop&#34;&gt;ar&lt;span style=&#34;margin-right:0.01389em;&#34;&gt;g&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.07847em;&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathdefault mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Iterative algorithms spelled out in maths notation always feel a bit clunky to me, so rather than doing that, here’s some Python code to do it:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; np

&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;cis&lt;/span&gt;(t):
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cos(t) &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1j&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sin(t)

&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;inverse_tri_sum_bandlimited&lt;/span&gt;(x):
    &lt;span style=&#34;color:#66d9ef&#34;&gt;assert&lt;/span&gt;(np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;isrealobj(x)) &lt;span style=&#34;color:#75715e&#34;&gt;# real signals only. i&amp;#39;m lazy&lt;/span&gt;

    n &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; len(x)
    nyquist &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; n &lt;span style=&#34;color:#f92672&#34;&gt;//&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;

    y &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;fft&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;fft(x)

    m &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;arange(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;, nyquist, &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
    coefs &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt; (m&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;m)

    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; k &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; range(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, nyquist&lt;span style=&#34;color:#f92672&#34;&gt;//&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;):
        &lt;span style=&#34;color:#75715e&#34;&gt;# indices of the non-zero components of a triangle wave&lt;/span&gt;
        &lt;span style=&#34;color:#75715e&#34;&gt;# with fundamental frequency k, not including the fundamental&lt;/span&gt;
        nz &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;arange(k&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;, nyquist, k&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)
        &lt;span style=&#34;color:#75715e&#34;&gt;# construct the frequency domain of the triangle wave and subtract it off&lt;/span&gt;
        y[nz] &lt;span style=&#34;color:#f92672&#34;&gt;-=&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;abs(y[k]) &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt; coefs[:len(nz)] &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt; cis(nz &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt; (np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;angle(y[k]) &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt; k))

    &lt;span style=&#34;color:#75715e&#34;&gt;# fix up conjugate symmetry&lt;/span&gt;
    y[nyquist&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;:] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;conj(y[nyquist&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;:&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;])

    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; y&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This makes use of the observation that once a frequency in &lt;code&gt;y&lt;/code&gt; has been zeroed out we never look at it again, so we can do the algorithm in-place. Also, band-limited triangle waves above half the nyquist frequency are just sine waves, so we don’t need to consider them at all.&lt;/p&gt;
&lt;h2 id=&#34;some-graphs-to-think-about&#34;&gt;Some Graphs To Think About&lt;/h2&gt;
&lt;p&gt;The nice thing about this algorithm is the result is in the same representation as given by the DFT. So, if the DFT is &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathcal&#34; style=&#34;margin-right:0.09931em;&#34;&gt;F&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; and our triangle transform is &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathcal&#34; style=&#34;margin-right:0.25417em;&#34;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;, then we can replace all the triangle waves in a function with sine waves by applying &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8141079999999999em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathcal&#34; style=&#34;margin-right:0.09931em;&#34;&gt;F&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8141079999999999em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;−&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathcal&#34; style=&#34;margin-right:0.25417em;&#34;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;. Right? So, this does what you might expect:&lt;/p&gt;

&lt;img src=&#34;https://graemephi.github.io/posts/triangle-dft/tritri.png&#34;/&gt;


&lt;p&gt;But look at this:&lt;/p&gt;

&lt;img src=&#34;https://graemephi.github.io/posts/triangle-dft/tribad.png&#34;/&gt;


&lt;p&gt;What gives? Well, this is a problem the DFT has, too. We’re getting a representation of the signal as a sum of triangle waves but &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord text&#34;&gt;&lt;span class=&#34;mord&#34;&gt;tri&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;mord text&#34;&gt;&lt;span class=&#34;mord textbf&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; isn’t one of them. In the analogous case for the DFT this isn’t so bad because it ends up being represented by nearby sine waves. You get a nice exponential drop-off away from the true frequency. For triangle waves, you don’t have that at all. Now, this is without windowing, so there is also a big jump between the last and first sample that we probably ought to do something about. Maybe if we apply a triangular window…&lt;/p&gt;

&lt;img src=&#34;https://graemephi.github.io/posts/triangle-dft/tristillbad.png&#34;/&gt;


&lt;p&gt;I don’t know what I expected.&lt;/p&gt;
&lt;p&gt;Anyway, the reason I did all this was to see if anything interesting happened when you messed around with it. For example, we can swap out out &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathcal&#34; style=&#34;margin-right:0.09931em;&#34;&gt;F&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; for &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathcal&#34; style=&#34;margin-right:0.25417em;&#34;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; in the &lt;a href=&#34;https://en.wikipedia.org/wiki/Convolution_theorem&#34;&gt;convolution theorem&lt;/a&gt;. Here is a gaussian filter applied in the “triangle domain”, with &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.03588em;&#34;&gt;σ&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.64444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; and with &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.03588em;&#34;&gt;σ&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.64444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;. &lt;a href=&#34;https://commons.wikimedia.org/wiki/File:Mandrill_Albert_September_2015_Zoo_Berlin_(2).jpg&#34;&gt;Image from Wikimedia&lt;/a&gt;.&lt;/p&gt;

&lt;div style=&#34;display: flex; justify-content: center;&#34; /&gt;
    &lt;img src=&#34;https://graemephi.github.io/posts/triangle-dft/mandril.png&#34;/&gt;
&lt;/div&gt;


&lt;p&gt;Interesting! I don’t really have an intuition for what’s happening on for &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.03588em;&#34;&gt;σ&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.64444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;. Larger values of &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.03588em;&#34;&gt;σ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; look a bit more like what I expected.&lt;/p&gt;
&lt;p&gt;I also tried filtering audio this way. Removing high frequency triangle waves–maybe I should give those a cute name like triquencies, because strictly speaking each one is multiple frequencies so I find it weird to refer to them that way–introduces high harmonics of low frequency content in the signal. This sounds really nice if you have something with lots of harmonic material–you get a nice wash of soft sawtooth buzz–and pretty bad on something with sparse hamonics, like a plucked string. It would be nice to be able to use this for some audio effect, buuut &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathcal&#34; style=&#34;margin-right:0.25417em;&#34;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; isn’t linear, so you can’t use the usual methods to convolve small filters with long signals. Oh, well.&lt;/p&gt;
&lt;h2 id=&#34;odds-and-ends&#34;&gt;Odds and Ends&lt;/h2&gt;
&lt;p&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.02778em;&#34;&gt;O&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop&#34;&gt;lo&lt;span style=&#34;margin-right:0.01389em;&#34;&gt;g&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;. I didn’t spell out this claim, however the naive algorithm is &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.064108em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.02778em;&#34;&gt;O&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8141079999999999em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;. But if we skip triangle wave frequencies that are zero then we only need to do &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.190108em;vertical-align:-0.345em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.845108em;&#34;&gt;&lt;span style=&#34;top:-2.6550000000000002em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.394em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.345em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.190108em;vertical-align:-0.345em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.845108em;&#34;&gt;&lt;span style=&#34;top:-2.6550000000000002em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;4&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.394em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.345em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.190108em;vertical-align:-0.345em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.845108em;&#34;&gt;&lt;span style=&#34;top:-2.6550000000000002em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;6&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.394em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.345em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.190108em;vertical-align:-0.345em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.845108em;&#34;&gt;&lt;span style=&#34;top:-2.6550000000000002em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;8&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.394em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.345em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.66666em;vertical-align:-0.08333em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.190108em;vertical-align:-0.345em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.845108em;&#34;&gt;&lt;span style=&#34;top:-2.6550000000000002em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathdefault mtight&#34;&gt;n&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.394em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.345em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; operations. Apparently, that series grows logarithmically.&lt;/p&gt;
&lt;p&gt;What about non-band-limited triangle waves? Well, it turns out the band-limited version is close enough you can just stick it in a non-linear least-squares solver and it’ll find you something near machine precision, despite the discontinuous Jacobian. But it’s just too slow for large problems to be all that interesting. Another thought is that if the problem is just that aliasing causes us to lose orthogonality, then can we not just upsample until the first &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; band-limited triangle waves are effectively identical to non-band-limited? But when I tried this it would produce better results up to around 64x upsampling, and then stop, not even close to the least-squares method. I don’t really understand this at all! It could just be the problem is ill-defined but it seems unlikely to me.&lt;/p&gt;
&lt;p&gt;At the top I said this would work for any periodic function: the DFT of any signal can be used in place of the fourier series of the triangle wave. But I’m not so interested in trying out other exotic functions like square waves as they would all have the problems laid out here, just because of how the series of functions was constructed. By band-limiting each basis function, we get a nice understanding of how the signal spans the fourier basis once shifted and sampled. But by that same token, only the complex exponential results in a series of orthogonal functions when constructed this way.&lt;/p&gt;
&lt;p&gt;Now I can stop thinking about this.&lt;/p&gt;
&lt;section class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id=&#34;fn1&#34; role=&#34;doc-endnote&#34;&gt;&lt;p&gt;Notably, I’ve swapped out the &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.66786em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop&#34;&gt;sin&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; for &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop&#34;&gt;cos&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;, which also makes &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.099108em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;−&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.849108em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathdefault mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; term you might be familiar with disappear. I do this because in the DFT, cosines with zero phase are represented by purely real frequency components. If we align our triangle wave with cosine, then our triangle wave is also made of purely real frequency components. This makes the discussion a little easier.&lt;a href=&#34;#fnref1&#34; class=&#34;footnote-back&#34; role=&#34;doc-backlink&#34;&gt;↩︎&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&#34;fn2&#34; role=&#34;doc-endnote&#34;&gt;&lt;p&gt;This is basically &lt;a href=&#34;https://en.wikipedia.org/wiki/Matching_pursuit&#34;&gt;matching pursuit&lt;/a&gt; with a specific dictionary and a method to cheaply compute the next atom to remove.&lt;a href=&#34;#fnref2&#34; class=&#34;footnote-back&#34; role=&#34;doc-backlink&#34;&gt;↩︎&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/section&gt;
</description>
    </item>
    
    <item>
      <title>Dumb Tricks With Phase Inversion</title>
      <link>https://graemephi.github.io/posts/dumb-tricks-with-phase-inversion/</link>
      <pubDate>Sun, 02 Jun 2019 12:34:03 +0100</pubDate>
      
      <guid>https://graemephi.github.io/posts/dumb-tricks-with-phase-inversion/</guid>
      <description>

&lt;p&gt;Phase inversion takes a signal 
&lt;span class=&#34;svgi&#34;&gt;&lt;svg height=&#34;18pt&#34; version=&#34;1.1&#34; viewBox=&#34;0 0 54 18&#34; width=&#34;54pt&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; xmlns:xlink=&#34;http://www.w3.org/1999/xlink&#34;&gt;
 &lt;g id=&#34;figure_1&#34;&gt;
  &lt;g id=&#34;patch_1&#34;&gt;
   &lt;path d=&#34;M 0 18
L 54 18
L 54 0
L 0 0
z
&#34; style=&#34;fill:none;&#34;/&gt;
  &lt;/g&gt;
  &lt;g id=&#34;axes_1&#34;&gt;
   &lt;g id=&#34;line2d_1&#34;&gt;
    &lt;path clip-path=&#34;url(#peaaa2fd3e3)&#34; d=&#34;M 2.454545 9
L 5.160344 7.124681
L 6.319971 6.545069
L 7.479599 6.207045
L 8.639227 6.150278
L 9.798855 6.380754
L 10.958482 6.863052
L 13.277738 8.210091
L 14.437366 8.79151
L 15.596994 9.099458
L 16.370079 9.088321
L 17.143164 8.878447
L 17.916249 8.469792
L 19.075877 7.541774
L 21.781675 5.054015
L 22.55476 4.662304
L 23.327845 4.567274
L 24.100931 4.814686
L 24.874016 5.407444
L 25.647101 6.29775
L 28.352899 9.956507
L 29.125984 10.46926
L 29.512527 10.540695
L 29.899069 10.474129
L 30.285612 10.265005
L 31.058697 9.431231
L 31.831782 8.128533
L 34.151038 3.664421
L 34.537581 3.224864
L 34.924123 2.964516
L 35.310666 2.906228
L 35.697208 3.06378
L 36.083751 3.440397
L 36.856836 4.805238
L 38.016464 7.901971
L 39.176092 10.989569
L 39.562634 11.72477
L 39.949177 12.217402
L 40.335719 12.424677
L 40.722262 12.31873
L 41.108805 11.88961
L 41.495347 11.14738
L 42.268432 8.868333
L 44.201145 2.038144
L 44.587688 1.234146
L 44.97423 0.818182
L 45.360773 0.840679
L 45.747316 1.32304
L 46.133858 2.253693
L 46.906943 5.240711
L 48.453114 12.560401
L 48.839656 13.831438
L 49.226199 14.606821
L 49.612742 14.796036
L 49.999284 14.352468
L 50.385827 13.28096
L 51.158912 9.548236
L 51.545455 7.163497
L 51.545455 7.163497
&#34; style=&#34;fill:none;stroke:#cc0d1a;stroke-linecap:square;stroke-width:1.5;&#34;/&gt;
   &lt;/g&gt;
  &lt;/g&gt;
 &lt;/g&gt;
 &lt;defs&gt;
  &lt;clipPath id=&#34;peaaa2fd3e3&#34;&gt;
   &lt;rect height=&#34;18&#34; width=&#34;54&#34; x=&#34;0&#34; y=&#34;0&#34;/&gt;
  &lt;/clipPath&gt;
 &lt;/defs&gt;
&lt;/svg&gt;
&lt;/span&gt;

 and flips it upside down 
&lt;span class=&#34;svgi&#34;&gt;&lt;svg height=&#34;18pt&#34; version=&#34;1.1&#34; viewBox=&#34;0 0 54 18&#34; width=&#34;54pt&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; xmlns:xlink=&#34;http://www.w3.org/1999/xlink&#34;&gt;
 &lt;g id=&#34;figure_1&#34;&gt;
  &lt;g id=&#34;patch_1&#34;&gt;
   &lt;path d=&#34;M 0 18
L 54 18
L 54 0
L 0 0
z
&#34; style=&#34;fill:none;&#34;/&gt;
  &lt;/g&gt;
  &lt;g id=&#34;axes_1&#34;&gt;
   &lt;g id=&#34;line2d_1&#34;&gt;
    &lt;path clip-path=&#34;url(#p6eb91deae1)&#34; d=&#34;M 2.454545 9
L 5.160344 10.875319
L 6.319971 11.454931
L 7.479599 11.792955
L 8.639227 11.849722
L 9.798855 11.619246
L 10.958482 11.136948
L 13.277738 9.789909
L 14.437366 9.20849
L 15.596994 8.900542
L 16.370079 8.911679
L 17.143164 9.121553
L 17.916249 9.530208
L 19.075877 10.458226
L 21.781675 12.945985
L 22.55476 13.337696
L 23.327845 13.432726
L 24.100931 13.185314
L 24.874016 12.592556
L 25.647101 11.70225
L 28.352899 8.043493
L 29.125984 7.53074
L 29.512527 7.459305
L 29.899069 7.525871
L 30.285612 7.734995
L 31.058697 8.568769
L 31.831782 9.871467
L 34.151038 14.335579
L 34.537581 14.775136
L 34.924123 15.035484
L 35.310666 15.093772
L 35.697208 14.93622
L 36.083751 14.559603
L 36.856836 13.194762
L 38.016464 10.098029
L 39.176092 7.010431
L 39.562634 6.27523
L 39.949177 5.782598
L 40.335719 5.575323
L 40.722262 5.68127
L 41.108805 6.11039
L 41.495347 6.85262
L 42.268432 9.131667
L 44.201145 15.961856
L 44.587688 16.765854
L 44.97423 17.181818
L 45.360773 17.159321
L 45.747316 16.67696
L 46.133858 15.746307
L 46.906943 12.759289
L 48.453114 5.439599
L 48.839656 4.168562
L 49.226199 3.393179
L 49.612742 3.203964
L 49.999284 3.647532
L 50.385827 4.71904
L 51.158912 8.451764
L 51.545455 10.836503
L 51.545455 10.836503
&#34; style=&#34;fill:none;stroke:#33f2e6;stroke-linecap:square;stroke-width:1.5;&#34;/&gt;
   &lt;/g&gt;
  &lt;/g&gt;
 &lt;/g&gt;
 &lt;defs&gt;
  &lt;clipPath id=&#34;p6eb91deae1&#34;&gt;
   &lt;rect height=&#34;18&#34; width=&#34;54&#34; x=&#34;0&#34; y=&#34;0&#34;/&gt;
  &lt;/clipPath&gt;
 &lt;/defs&gt;
&lt;/svg&gt;
&lt;/span&gt;

. Most people are introduced to it as a button you push in a DAW while troubleshooting phase problems, but with some thinking it&amp;rsquo;s capable of a lot more than that. Some digging in the audio DSP literature will uncover a stray sentence or two that acknowledges this, but I get the impression that it strikes the people who already know it as too obvious to be worth mentioning. The really nice thing about it is that it all works in a DAW&amp;ndash;you don&amp;rsquo;t need to break out Max/MSP or Reaktor to experiment with it.&lt;/p&gt;

&lt;p&gt;I&amp;rsquo;m pretty sure I originally got the basic idea for all this from &lt;a href=&#34;https://vladgsound.wordpress.com/&#34;&gt;vladg/sound&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;
&lt;blockquote class=&#34;aside&#34;&gt;




My intuition for this is fairly algebraic so I&amp;rsquo;ll be leaning on that a little, but all you need to have is an intuition for what is happening when you route audio around in a DAW. That said, I will be using notation from digital signal processing that&amp;rsquo;s too useful to give up: &lt;code&gt;x[n]&lt;/code&gt; reads as the &lt;code&gt;n&lt;/code&gt;th sample of a signal &lt;code&gt;x&lt;/code&gt;. Then &lt;code&gt;c[n] = a[n] + b[n]&lt;/code&gt; describes &lt;code&gt;c&lt;/code&gt; by telling you how to compute the &lt;code&gt;n&lt;/code&gt;th sample of &lt;code&gt;c&lt;/code&gt; in terms of signals &lt;code&gt;a&lt;/code&gt; and &lt;code&gt;b&lt;/code&gt;. We could drop the &lt;code&gt;[n]&lt;/code&gt;, but this makes clear that we don&amp;rsquo;t need to know anything about &lt;code&gt;a&lt;/code&gt; or &lt;code&gt;b&lt;/code&gt; other than their &lt;code&gt;n&lt;/code&gt;th samples to compute the &lt;code&gt;n&lt;/code&gt;th sample of &lt;code&gt;c&lt;/code&gt;. For anything more complicated than this, I&amp;rsquo;ll use graphics.



&lt;/blockquote&gt;

&lt;/p&gt;

&lt;h3 id=&#34;diffing&#34;&gt;Diffing&lt;/h3&gt;

&lt;p&gt;Phase inversion negates a signal, &lt;code&gt;y[n] = -x[n]&lt;/code&gt;, so it turns addition (mixing) into subtraction.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;
&lt;span class=&#34;svgi&#34;&gt;&lt;svg height=&#34;36pt&#34; version=&#34;1.1&#34; viewBox=&#34;0 0 72 36&#34; width=&#34;72pt&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; xmlns:xlink=&#34;http://www.w3.org/1999/xlink&#34;&gt;
 &lt;g id=&#34;figure_1&#34;&gt;
  &lt;g id=&#34;patch_1&#34;&gt;
   &lt;path d=&#34;M 0 36
L 72 36
L 72 0
L 0 0
z
&#34; style=&#34;fill:none;&#34;/&gt;
  &lt;/g&gt;
  &lt;g id=&#34;axes_1&#34;&gt;
   &lt;g id=&#34;line2d_1&#34;&gt;
    &lt;path clip-path=&#34;url(#p12c0a407d9)&#34; d=&#34;M 3.272727 18
L 4.818898 17.845997
L 5.849678 17.741868
L 6.880458 17.855032
L 8.426628 18.425267
L 9.457409 18.709453
L 9.972799 18.702718
L 10.488189 18.567014
L 11.518969 17.952004
L 13.06514 16.892645
L 13.58053 16.762056
L 14.09592 16.825713
L 14.61131 17.094047
L 15.64209 18.112505
L 16.67287 19.262823
L 17.188261 19.646872
L 17.703651 19.793136
L 18.219041 19.657607
L 18.734431 19.240425
L 19.765211 17.793954
L 20.795991 16.266843
L 21.311382 15.791182
L 21.826772 15.641467
L 22.342162 15.862589
L 22.857552 16.441138
L 23.888332 18.328225
L 24.919112 20.222477
L 25.434503 20.778483
L 25.949893 20.918844
L 26.465283 20.600297
L 26.980673 19.851828
L 28.011453 17.522566
L 29.042233 15.279856
L 29.557623 14.656688
L 30.073014 14.538279
L 30.588404 14.963911
L 31.103794 15.887203
L 32.134574 18.651331
L 33.165354 21.217699
L 33.680744 21.894009
L 34.196135 21.978618
L 34.711525 21.438309
L 35.226915 20.338218
L 37.288475 14.290754
L 37.803865 13.575329
L 38.319256 13.535371
L 38.834646 14.196227
L 39.350036 15.473029
L 41.411596 22.191119
L 41.926986 22.932112
L 42.442377 22.917582
L 42.957767 22.131613
L 43.473157 20.679516
L 45.534717 13.338901
L 46.050107 12.585222
L 46.565497 12.663164
L 47.080888 13.577831
L 47.596278 15.202935
L 49.142448 21.592114
L 49.657838 23.117561
L 50.173228 23.871713
L 50.688618 23.72224
L 51.204009 22.676109
L 51.719399 20.880997
L 53.265569 14.025774
L 53.780959 12.441158
L 54.296349 11.698141
L 54.811739 11.9265
L 55.32713 13.106045
L 55.84252 15.067407
L 57.38869 22.352921
L 57.90408 23.982944
L 58.41947 24.703785
L 58.93486 24.389972
L 59.450251 23.075968
L 59.965641 20.95301
L 61.511811 13.274362
L 62.027201 11.612473
L 62.542591 10.924272
L 63.057981 11.329249
L 63.573372 12.777742
L 64.604152 17.820624
L 65.634932 23.089597
L 66.150322 24.770043
L 66.665712 25.41577
L 67.181102 24.914856
L 67.696492 23.332948
L 68.727273 18
L 68.727273 18
&#34; style=&#34;fill:none;stroke:#1a0dcc;stroke-linecap:square;stroke-width:1.5;&#34;/&gt;
   &lt;/g&gt;
  &lt;/g&gt;
 &lt;/g&gt;
 &lt;defs&gt;
  &lt;clipPath id=&#34;p12c0a407d9&#34;&gt;
   &lt;rect height=&#34;36&#34; width=&#34;72&#34; x=&#34;0&#34; y=&#34;0&#34;/&gt;
  &lt;/clipPath&gt;
 &lt;/defs&gt;
&lt;/svg&gt;
&lt;/span&gt;

 + 
&lt;span class=&#34;svgi&#34;&gt;&lt;svg height=&#34;36pt&#34; version=&#34;1.1&#34; viewBox=&#34;0 0 72 36&#34; width=&#34;72pt&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; xmlns:xlink=&#34;http://www.w3.org/1999/xlink&#34;&gt;
 &lt;g id=&#34;figure_1&#34;&gt;
  &lt;g id=&#34;patch_1&#34;&gt;
   &lt;path d=&#34;M 0 36
L 72 36
L 72 0
L 0 0
z
&#34; style=&#34;fill:none;&#34;/&gt;
  &lt;/g&gt;
  &lt;g id=&#34;axes_1&#34;&gt;
   &lt;g id=&#34;line2d_1&#34;&gt;
    &lt;path clip-path=&#34;url(#p4619e8d299)&#34; d=&#34;M 3.272727 18
L 4.303508 14.234528
L 4.818898 12.817613
L 5.334288 11.879652
L 5.849678 11.493518
L 6.365068 11.681743
L 6.880458 12.415541
L 7.395848 13.618464
L 8.426628 16.938228
L 9.457409 20.451425
L 9.972799 21.894522
L 10.488189 22.96038
L 11.003579 23.565993
L 11.518969 23.671277
L 12.034359 23.281442
L 12.549749 22.445234
L 13.58053 19.809462
L 15.1267 15.377246
L 15.64209 14.290799
L 16.15748 13.563913
L 16.67287 13.247309
L 17.188261 13.353757
L 17.703651 13.858304
L 18.219041 14.70187
L 19.249821 17.040424
L 20.280601 19.510516
L 20.795991 20.52444
L 21.311382 21.276531
L 21.826772 21.712493
L 22.342162 21.808204
L 22.857552 21.57056
L 23.372942 21.035494
L 24.403722 19.33308
L 25.949893 16.480366
L 26.465283 15.782941
L 26.980673 15.313492
L 27.496063 15.100993
L 28.011453 15.150239
L 28.526843 15.442672
L 29.557623 16.585168
L 31.619184 19.343217
L 32.134574 19.777248
L 32.649964 20.030023
L 33.165354 20.091044
L 33.680744 19.967512
L 34.711525 19.272181
L 37.288475 16.953104
L 37.803865 16.719605
L 38.319256 16.615856
L 38.834646 16.640577
L 39.865426 17.014759
L 42.957767 18.694381
L 43.988547 18.80509
L 45.019327 18.631471
L 48.111668 17.714971
L 49.142448 17.648878
L 50.688618 17.792429
L 52.750179 18.025421
L 54.811739 17.992733
L 56.8733 17.940105
L 58.93486 18.126316
L 60.996421 18.283154
L 62.542591 18.141656
L 66.150322 17.552444
L 67.181102 17.632444
L 68.727273 18
L 68.727273 18
&#34; style=&#34;fill:none;stroke:#cc0d1a;stroke-linecap:square;stroke-width:1.5;&#34;/&gt;
   &lt;/g&gt;
  &lt;/g&gt;
 &lt;/g&gt;
 &lt;defs&gt;
  &lt;clipPath id=&#34;p4619e8d299&#34;&gt;
   &lt;rect height=&#34;36&#34; width=&#34;72&#34; x=&#34;0&#34; y=&#34;0&#34;/&gt;
  &lt;/clipPath&gt;
 &lt;/defs&gt;
&lt;/svg&gt;
&lt;/span&gt;

 = 
&lt;span class=&#34;svgi&#34;&gt;&lt;svg height=&#34;36pt&#34; version=&#34;1.1&#34; viewBox=&#34;0 0 72 36&#34; width=&#34;72pt&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; xmlns:xlink=&#34;http://www.w3.org/1999/xlink&#34;&gt;
 &lt;g id=&#34;figure_1&#34;&gt;
  &lt;g id=&#34;patch_1&#34;&gt;
   &lt;path d=&#34;M 0 36
L 72 36
L 72 0
L 0 0
z
&#34; style=&#34;fill:none;&#34;/&gt;
  &lt;/g&gt;
  &lt;g id=&#34;axes_1&#34;&gt;
   &lt;g id=&#34;line2d_1&#34;&gt;
    &lt;path clip-path=&#34;url(#p320c124c7d)&#34; d=&#34;M 3.272727 18
L 4.303508 14.156411
L 4.818898 12.663609
L 5.334288 11.656456
L 5.849678 11.235386
L 6.365068 11.445756
L 6.880458 12.270572
L 7.395848 13.629849
L 8.426628 17.363495
L 9.457409 21.160878
L 9.972799 22.597239
L 10.488189 23.527394
L 11.003579 23.872996
L 11.518969 23.623281
L 12.034359 22.834729
L 13.06514 20.141969
L 14.09592 17.084997
L 14.61131 15.831926
L 15.1267 14.919721
L 15.64209 14.403304
L 16.15748 14.28292
L 16.67287 14.510132
L 17.188261 15.000628
L 19.765211 18.109491
L 20.795991 18.791283
L 22.857552 20.011698
L 23.888332 20.591713
L 24.403722 20.689369
L 24.919112 20.555522
L 25.434503 20.132505
L 25.949893 19.399209
L 26.980673 17.165319
L 28.011453 14.672804
L 28.526843 13.734837
L 29.042233 13.219134
L 29.557623 13.241856
L 30.073014 13.853625
L 30.588404 15.024997
L 31.619184 18.523505
L 32.649964 22.103026
L 33.165354 23.308743
L 33.680744 23.86152
L 34.196135 23.661183
L 34.711525 22.710489
L 35.226915 21.11931
L 37.288475 13.243858
L 37.803865 12.294934
L 38.319256 12.151227
L 38.834646 12.836804
L 39.350036 14.253993
L 41.411596 22.164595
L 41.926986 23.205633
L 42.442377 23.437028
L 42.957767 22.825995
L 43.473157 21.469213
L 45.534717 13.812567
L 46.050107 12.879496
L 46.565497 12.776185
L 47.080888 13.525376
L 47.596278 15.014732
L 49.657838 22.790513
L 50.173228 23.596116
L 50.688618 23.514669
L 51.204009 22.541863
L 51.719399 20.815029
L 53.265569 14.067047
L 53.780959 12.479096
L 54.296349 11.717791
L 54.811739 11.919234
L 55.32713 13.070634
L 55.84252 15.009995
L 57.38869 22.318484
L 57.90408 23.991093
L 58.41947 24.767633
L 58.93486 24.516287
L 59.450251 23.263612
L 59.965641 21.192338
L 61.511811 13.539017
L 62.027201 11.82922
L 62.542591 11.065928
L 63.057981 11.374104
L 63.573372 12.712357
L 64.088762 14.877851
L 65.634932 22.662657
L 66.150322 24.322487
L 66.665712 24.987951
L 67.181102 24.5473
L 67.696492 23.062357
L 68.727273 18
L 68.727273 18
&#34; style=&#34;fill:none;stroke:#e61ae6;stroke-linecap:square;stroke-width:1.5;&#34;/&gt;
   &lt;/g&gt;
  &lt;/g&gt;
 &lt;/g&gt;
 &lt;defs&gt;
  &lt;clipPath id=&#34;p320c124c7d&#34;&gt;
   &lt;rect height=&#34;36&#34; width=&#34;72&#34; x=&#34;0&#34; y=&#34;0&#34;/&gt;
  &lt;/clipPath&gt;
 &lt;/defs&gt;
&lt;/svg&gt;
&lt;/span&gt;

 = 
&lt;span class=&#34;svgi&#34;&gt;&lt;svg height=&#34;36pt&#34; version=&#34;1.1&#34; viewBox=&#34;0 0 72 36&#34; width=&#34;72pt&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; xmlns:xlink=&#34;http://www.w3.org/1999/xlink&#34;&gt;
 &lt;g id=&#34;figure_1&#34;&gt;
  &lt;g id=&#34;patch_1&#34;&gt;
   &lt;path d=&#34;M 0 36
L 72 36
L 72 0
L 0 0
z
&#34; style=&#34;fill:none;&#34;/&gt;
  &lt;/g&gt;
  &lt;g id=&#34;axes_1&#34;&gt;
   &lt;g id=&#34;line2d_1&#34;&gt;
    &lt;path clip-path=&#34;url(#p12c0a407d9)&#34; d=&#34;M 3.272727 18
L 4.818898 17.845997
L 5.849678 17.741868
L 6.880458 17.855032
L 8.426628 18.425267
L 9.457409 18.709453
L 9.972799 18.702718
L 10.488189 18.567014
L 11.518969 17.952004
L 13.06514 16.892645
L 13.58053 16.762056
L 14.09592 16.825713
L 14.61131 17.094047
L 15.64209 18.112505
L 16.67287 19.262823
L 17.188261 19.646872
L 17.703651 19.793136
L 18.219041 19.657607
L 18.734431 19.240425
L 19.765211 17.793954
L 20.795991 16.266843
L 21.311382 15.791182
L 21.826772 15.641467
L 22.342162 15.862589
L 22.857552 16.441138
L 23.888332 18.328225
L 24.919112 20.222477
L 25.434503 20.778483
L 25.949893 20.918844
L 26.465283 20.600297
L 26.980673 19.851828
L 28.011453 17.522566
L 29.042233 15.279856
L 29.557623 14.656688
L 30.073014 14.538279
L 30.588404 14.963911
L 31.103794 15.887203
L 32.134574 18.651331
L 33.165354 21.217699
L 33.680744 21.894009
L 34.196135 21.978618
L 34.711525 21.438309
L 35.226915 20.338218
L 37.288475 14.290754
L 37.803865 13.575329
L 38.319256 13.535371
L 38.834646 14.196227
L 39.350036 15.473029
L 41.411596 22.191119
L 41.926986 22.932112
L 42.442377 22.917582
L 42.957767 22.131613
L 43.473157 20.679516
L 45.534717 13.338901
L 46.050107 12.585222
L 46.565497 12.663164
L 47.080888 13.577831
L 47.596278 15.202935
L 49.142448 21.592114
L 49.657838 23.117561
L 50.173228 23.871713
L 50.688618 23.72224
L 51.204009 22.676109
L 51.719399 20.880997
L 53.265569 14.025774
L 53.780959 12.441158
L 54.296349 11.698141
L 54.811739 11.9265
L 55.32713 13.106045
L 55.84252 15.067407
L 57.38869 22.352921
L 57.90408 23.982944
L 58.41947 24.703785
L 58.93486 24.389972
L 59.450251 23.075968
L 59.965641 20.95301
L 61.511811 13.274362
L 62.027201 11.612473
L 62.542591 10.924272
L 63.057981 11.329249
L 63.573372 12.777742
L 64.604152 17.820624
L 65.634932 23.089597
L 66.150322 24.770043
L 66.665712 25.41577
L 67.181102 24.914856
L 67.696492 23.332948
L 68.727273 18
L 68.727273 18
&#34; style=&#34;fill:none;stroke:#1a0dcc;stroke-linecap:square;stroke-width:1.5;&#34;/&gt;
   &lt;/g&gt;
  &lt;/g&gt;
 &lt;/g&gt;
 &lt;defs&gt;
  &lt;clipPath id=&#34;p12c0a407d9&#34;&gt;
   &lt;rect height=&#34;36&#34; width=&#34;72&#34; x=&#34;0&#34; y=&#34;0&#34;/&gt;
  &lt;/clipPath&gt;
 &lt;/defs&gt;
&lt;/svg&gt;
&lt;/span&gt;

 - 
&lt;span class=&#34;svgi&#34;&gt;&lt;svg height=&#34;36pt&#34; version=&#34;1.1&#34; viewBox=&#34;0 0 72 36&#34; width=&#34;72pt&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; xmlns:xlink=&#34;http://www.w3.org/1999/xlink&#34;&gt;
 &lt;g id=&#34;figure_1&#34;&gt;
  &lt;g id=&#34;patch_1&#34;&gt;
   &lt;path d=&#34;M 0 36
L 72 36
L 72 0
L 0 0
z
&#34; style=&#34;fill:none;&#34;/&gt;
  &lt;/g&gt;
  &lt;g id=&#34;axes_1&#34;&gt;
   &lt;g id=&#34;line2d_1&#34;&gt;
    &lt;path clip-path=&#34;url(#p4b9a36d3ff)&#34; d=&#34;M 3.272727 18
L 4.303508 21.765472
L 4.818898 23.182387
L 5.334288 24.120348
L 5.849678 24.506482
L 6.365068 24.318257
L 6.880458 23.584459
L 7.395848 22.381536
L 8.426628 19.061772
L 9.457409 15.548575
L 9.972799 14.105478
L 10.488189 13.03962
L 11.003579 12.434007
L 11.518969 12.328723
L 12.034359 12.718558
L 12.549749 13.554766
L 13.58053 16.190538
L 15.1267 20.622754
L 15.64209 21.709201
L 16.15748 22.436087
L 16.67287 22.752691
L 17.188261 22.646243
L 17.703651 22.141696
L 18.219041 21.29813
L 19.249821 18.959576
L 20.280601 16.489484
L 20.795991 15.47556
L 21.311382 14.723469
L 21.826772 14.287507
L 22.342162 14.191796
L 22.857552 14.42944
L 23.372942 14.964506
L 24.403722 16.66692
L 25.949893 19.519634
L 26.465283 20.217059
L 26.980673 20.686508
L 27.496063 20.899007
L 28.011453 20.849761
L 28.526843 20.557328
L 29.557623 19.414832
L 31.619184 16.656783
L 32.134574 16.222752
L 32.649964 15.969977
L 33.165354 15.908956
L 33.680744 16.032488
L 34.711525 16.727819
L 37.288475 19.046896
L 37.803865 19.280395
L 38.319256 19.384144
L 38.834646 19.359423
L 39.865426 18.985241
L 42.957767 17.305619
L 43.988547 17.19491
L 45.019327 17.368529
L 48.111668 18.285029
L 49.142448 18.351122
L 50.688618 18.207571
L 52.750179 17.974579
L 54.811739 18.007267
L 56.8733 18.059895
L 58.93486 17.873684
L 60.996421 17.716846
L 62.542591 17.858344
L 66.150322 18.447556
L 67.181102 18.367556
L 68.727273 18
L 68.727273 18
&#34; style=&#34;fill:none;stroke:#33f2e6;stroke-linecap:square;stroke-width:1.5;&#34;/&gt;
   &lt;/g&gt;
  &lt;/g&gt;
 &lt;/g&gt;
 &lt;defs&gt;
  &lt;clipPath id=&#34;p4b9a36d3ff&#34;&gt;
   &lt;rect height=&#34;36&#34; width=&#34;72&#34; x=&#34;0&#34; y=&#34;0&#34;/&gt;
  &lt;/clipPath&gt;
 &lt;/defs&gt;
&lt;/svg&gt;
&lt;/span&gt;

&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;The first thing to notice about this is if we add a signal to itself, phase inverted, we get silence.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;
&lt;span class=&#34;svgi&#34;&gt;&lt;svg height=&#34;36pt&#34; version=&#34;1.1&#34; viewBox=&#34;0 0 72 36&#34; width=&#34;72pt&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; xmlns:xlink=&#34;http://www.w3.org/1999/xlink&#34;&gt;
 &lt;g id=&#34;figure_1&#34;&gt;
  &lt;g id=&#34;patch_1&#34;&gt;
   &lt;path d=&#34;M 0 36
L 72 36
L 72 0
L 0 0
z
&#34; style=&#34;fill:none;&#34;/&gt;
  &lt;/g&gt;
  &lt;g id=&#34;axes_1&#34;&gt;
   &lt;g id=&#34;line2d_1&#34;&gt;
    &lt;path clip-path=&#34;url(#p5797117576)&#34; d=&#34;M 3.272727 18
L 4.818898 7.930427
L 5.849678 2.95669
L 6.365068 1.306986
L 6.880458 0.308895
L 7.395848 0.001377
L 7.911238 0.396435
L 8.426628 1.478649
L 8.942019 3.205774
L 9.972799 8.302543
L 11.518969 18.44522
L 13.06514 28.435528
L 14.09592 33.283189
L 14.61131 34.854462
L 15.1267 35.76782
L 15.64209 35.98761
L 16.15748 35.505254
L 16.67287 34.33958
L 17.188261 32.536089
L 18.219041 27.319407
L 19.765211 17.109833
L 21.311382 7.204903
L 22.342162 2.486283
L 22.857552 0.994403
L 23.372942 0.166338
L 23.888332 0.034409
L 24.403722 0.603768
L 24.919112 1.85219
L 25.434503 3.730942
L 26.465283 9.064345
L 28.011453 19.33457
L 29.557623 29.148061
L 30.588404 33.734753
L 31.103794 35.146327
L 31.619184 35.888593
L 32.134574 35.932578
L 32.649964 35.276565
L 33.165354 33.94616
L 33.680744 31.993296
L 34.711525 26.546435
L 38.319256 4.006704
L 38.834646 2.05384
L 39.350036 0.723435
L 39.865426 0.067422
L 40.380816 0.111407
L 40.896206 0.853673
L 41.411596 2.265247
L 41.926986 4.291028
L 42.957767 9.848014
L 46.050107 29.833314
L 46.565497 32.269058
L 47.080888 34.14781
L 47.596278 35.396232
L 48.111668 35.965591
L 48.627058 35.833662
L 49.142448 35.005597
L 49.657838 33.513717
L 50.173228 31.416259
L 51.204009 25.752549
L 54.296349 5.834817
L 54.811739 3.463911
L 55.32713 1.66042
L 55.84252 0.494746
L 56.35791 0.01239
L 56.8733 0.23218
L 57.38869 1.145538
L 57.90408 2.716811
L 58.41947 4.884662
L 59.450251 10.651632
L 62.542591 30.489608
L 63.057981 32.794226
L 63.573372 34.521351
L 64.088762 35.603565
L 64.604152 35.998623
L 65.119542 35.691105
L 65.634932 34.693014
L 66.150322 33.04331
L 66.665712 30.806391
L 67.696492 24.93969
L 68.727273 18
L 68.727273 18
&#34; style=&#34;fill:none;stroke:#cc0d1a;stroke-linecap:square;stroke-width:1.5;&#34;/&gt;
   &lt;/g&gt;
  &lt;/g&gt;
 &lt;/g&gt;
 &lt;defs&gt;
  &lt;clipPath id=&#34;p5797117576&#34;&gt;
   &lt;rect height=&#34;36&#34; width=&#34;72&#34; x=&#34;0&#34; y=&#34;0&#34;/&gt;
  &lt;/clipPath&gt;
 &lt;/defs&gt;
&lt;/svg&gt;
&lt;/span&gt;

 + 
&lt;span class=&#34;svgi&#34;&gt;&lt;svg height=&#34;36pt&#34; version=&#34;1.1&#34; viewBox=&#34;0 0 72 36&#34; width=&#34;72pt&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; xmlns:xlink=&#34;http://www.w3.org/1999/xlink&#34;&gt;
 &lt;g id=&#34;figure_1&#34;&gt;
  &lt;g id=&#34;patch_1&#34;&gt;
   &lt;path d=&#34;M 0 36
L 72 36
L 72 0
L 0 0
z
&#34; style=&#34;fill:none;&#34;/&gt;
  &lt;/g&gt;
  &lt;g id=&#34;axes_1&#34;&gt;
   &lt;g id=&#34;line2d_1&#34;&gt;
    &lt;path clip-path=&#34;url(#pa94d880bf0)&#34; d=&#34;M 3.272727 18
L 4.818898 28.069573
L 5.849678 33.04331
L 6.365068 34.693014
L 6.880458 35.691105
L 7.395848 35.998623
L 7.911238 35.603565
L 8.426628 34.521351
L 8.942019 32.794226
L 9.972799 27.697457
L 11.518969 17.55478
L 13.06514 7.564472
L 14.09592 2.716811
L 14.61131 1.145538
L 15.1267 0.23218
L 15.64209 0.01239
L 16.15748 0.494746
L 16.67287 1.66042
L 17.188261 3.463911
L 18.219041 8.680593
L 19.765211 18.890167
L 21.311382 28.795097
L 22.342162 33.513717
L 22.857552 35.005597
L 23.372942 35.833662
L 23.888332 35.965591
L 24.403722 35.396232
L 24.919112 34.14781
L 25.434503 32.269058
L 26.465283 26.935655
L 28.011453 16.66543
L 29.557623 6.851939
L 30.588404 2.265247
L 31.103794 0.853673
L 31.619184 0.111407
L 32.134574 0.067422
L 32.649964 0.723435
L 33.165354 2.05384
L 33.680744 4.006704
L 34.711525 9.453565
L 38.319256 31.993296
L 38.834646 33.94616
L 39.350036 35.276565
L 39.865426 35.932578
L 40.380816 35.888593
L 40.896206 35.146327
L 41.411596 33.734753
L 41.926986 31.708972
L 42.957767 26.151986
L 46.050107 6.166686
L 46.565497 3.730942
L 47.080888 1.85219
L 47.596278 0.603768
L 48.111668 0.034409
L 48.627058 0.166338
L 49.142448 0.994403
L 49.657838 2.486283
L 50.173228 4.583741
L 51.204009 10.247451
L 54.296349 30.165183
L 54.811739 32.536089
L 55.32713 34.33958
L 55.84252 35.505254
L 56.35791 35.98761
L 56.8733 35.76782
L 57.38869 34.854462
L 57.90408 33.283189
L 58.41947 31.115338
L 59.450251 25.348368
L 62.542591 5.510392
L 63.057981 3.205774
L 63.573372 1.478649
L 64.088762 0.396435
L 64.604152 0.001377
L 65.119542 0.308895
L 65.634932 1.306986
L 66.150322 2.95669
L 66.665712 5.193609
L 67.696492 11.06031
L 68.727273 18
L 68.727273 18
&#34; style=&#34;fill:none;stroke:#33f2e6;stroke-linecap:square;stroke-width:1.5;&#34;/&gt;
   &lt;/g&gt;
  &lt;/g&gt;
 &lt;/g&gt;
 &lt;defs&gt;
  &lt;clipPath id=&#34;pa94d880bf0&#34;&gt;
   &lt;rect height=&#34;36&#34; width=&#34;72&#34; x=&#34;0&#34; y=&#34;0&#34;/&gt;
  &lt;/clipPath&gt;
 &lt;/defs&gt;
&lt;/svg&gt;
&lt;/span&gt;

 = 
&lt;span class=&#34;svgi&#34;&gt;&lt;svg height=&#34;36pt&#34; version=&#34;1.1&#34; viewBox=&#34;0 0 72 36&#34; width=&#34;72pt&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; xmlns:xlink=&#34;http://www.w3.org/1999/xlink&#34;&gt;
 &lt;g id=&#34;figure_1&#34;&gt;
  &lt;g id=&#34;patch_1&#34;&gt;
   &lt;path d=&#34;M 0 36
L 72 36
L 72 0
L 0 0
z
&#34; style=&#34;fill:none;&#34;/&gt;
  &lt;/g&gt;
  &lt;g id=&#34;axes_1&#34;&gt;
   &lt;g id=&#34;line2d_1&#34;&gt;
    &lt;path clip-path=&#34;url(#p6acbd377c5)&#34; d=&#34;M 3.272727 18
L 68.727273 18
L 68.727273 18
&#34; style=&#34;fill:none;stroke:#777777;stroke-linecap:square;stroke-width:1.5;&#34;/&gt;
   &lt;/g&gt;
  &lt;/g&gt;
 &lt;/g&gt;
 &lt;defs&gt;
  &lt;clipPath id=&#34;p6acbd377c5&#34;&gt;
   &lt;rect height=&#34;36&#34; width=&#34;72&#34; x=&#34;0&#34; y=&#34;0&#34;/&gt;
  &lt;/clipPath&gt;
 &lt;/defs&gt;
&lt;/svg&gt;
&lt;/span&gt;

&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;There is a vocals isolation trick that relies on this. That&amp;rsquo;s not what this post is about.&lt;/p&gt;

&lt;p&gt;What we&amp;rsquo;re interested in is signals before and after applying an audio effect. Some audio plugins have this built-in; Ableton&amp;rsquo;s EQ8 allows you to listen to each equaliser band in isolation. You could always do this yourself by flipping the phase of the equalised signal and mixing it back in with the original. Doing so in a DAW can be cumbersome, so when plugins do it for you, it can be very nice if this is all you want. But there is nothing stopping you taking the difference of a whole chain of effects, and you have to do it yourself for plugins that don&amp;rsquo;t have this feature.&lt;/p&gt;

&lt;p&gt;But there&amp;rsquo;s a consequence to this that is not obvious. We can add the difference signal to the dry signal to recreate the wet signal. Algebraically, &lt;code&gt;b[n] = a[n] + (b[n] - a[n])&lt;/code&gt;. &lt;em&gt;This&lt;/em&gt; is what this post is about. Whenever we have an effect in a signal chain, we can interpret the effect as &lt;em&gt;mixing in&lt;/em&gt; a difference signal to change the dry audio to the wet audio, and we are free to do any processing we want on the difference signal. Now, this is an interpretation, and it&amp;rsquo;s a wrong one. But we can have some fun with it.&lt;/p&gt;

&lt;p&gt;By the way, I&amp;rsquo;m trying to keep this post DAW-agnostic but at the end I describe how I do this in Ableton Live in a self-contained way that doesn&amp;rsquo;t involve six hundred sends. So, check that out if you&amp;rsquo;re confused how to actually do this in a DAW.&lt;/p&gt;

&lt;h3 id=&#34;dry-wet-mixing&#34;&gt;Dry/Wet Mixing&lt;/h3&gt;

&lt;p&gt;The simplest thing we can do with the difference signal idea is to implement dry/wet mixing. This is less useful for single effects, which have this built in, than it is for effect chains, which don&amp;rsquo;t.&lt;/p&gt;

&lt;p&gt;This is easy: turn the gain down on the difference signal. This will fade between from the wet to the dry signal. But if you&amp;rsquo;re willing to deal with a little algebra I think it&amp;rsquo;s worth exploring to what extent this is really dry/wet mixing, or something else. In dry/wet mixing, we mix two signals in such a way that the net gain sums to one,&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;c[n] = g*a[n] + (1 - g)*b[n]&lt;/code&gt;,&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;where &lt;code&gt;g&lt;/code&gt; fades between &lt;code&gt;a&lt;/code&gt; when &lt;code&gt;g&lt;/code&gt; is 0 (-∞ dB) and &lt;code&gt;b&lt;/code&gt; when &lt;code&gt;g&lt;/code&gt; is 1 (0 dB). By multiplying out and regathering we get&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;c[n] = b[n] + g*(a[n] - b[n])&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;so a dry/wet mix knob is directly equivalent to mixing in the difference signal. Note that &lt;code&gt;a&lt;/code&gt; and &lt;code&gt;b&lt;/code&gt; have swapped around; the phase of the difference signal has been inverted. In practice, you get to choose which way you want, which I&amp;rsquo;ll touch on later.&lt;/p&gt;

&lt;p&gt;This is no big deal. Putting an effect chain on a return track and balancing it with the source track will be easiser most of the time.&lt;/p&gt;

&lt;h3 id=&#34;filters&#34;&gt;Filters&lt;/h3&gt;

&lt;p&gt;This is well known among DSP people. A highpass filter can be made from a lowpass filter by subtracting the filtered signal from the original: &lt;code&gt;hp[n] = x[n] - lp[n]&lt;/code&gt;. It works the other way around, too, and with bandpass filters. If you think about this for a moment this is kind of obvious but may be surprising. If a lowpass filter removes high frequencies, then whatever is left are low frequencies, and subtracting those from the original signal will get rid of those low frequencies. But our differencing operation operates on single samples from each signal&amp;ndash;independent of any samples before or after&amp;ndash;and a single sample is just a number without any frequency information. So, given a lowpass filter, there is some highpass filter for which we can know the value of &lt;code&gt;hp[n]&lt;/code&gt; knowing only the two samples &lt;code&gt;x[n]&lt;/code&gt; and &lt;code&gt;lp[n]&lt;/code&gt;. Showing why this works mathematically isn&amp;rsquo;t hard&lt;sup class=&#34;footnote-ref&#34; id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34;&gt;1&lt;/a&gt;&lt;/sup&gt; but something cool is happening here and I think it would be a mistake to dismiss it as obvious.&lt;/p&gt;

&lt;p&gt;With a little tinkering we can start making bandpass and bandstop filters the same way, and go on to shelving and bell filters. But all we&amp;rsquo;ve done so far is recreate things we can already do, and I want to get to the good stuff.&lt;/p&gt;

&lt;h3 id=&#34;multiband-compression&#34;&gt;Multiband Compression&lt;/h3&gt;

&lt;p&gt;The reason why you&amp;rsquo;d want to use the filters described above is that we can recover the original signal exactly by mixing them together again: &lt;code&gt;x[n] = lp[n] + hp[n]&lt;/code&gt;. We don&amp;rsquo;t have to think about how we parameterise the filters or anything because we&amp;rsquo;ve used our phase inversion trick to make one filter from the other. Now all that is left is to compress just one of those filtered signals, do the sum, and we have a multiband compressor. Building this out in a DAW can be tricky but, to be clear here, it lets you combine &lt;em&gt;any&lt;/em&gt; set of filter plugins and &lt;em&gt;any&lt;/em&gt; set of compressor plugins into a multiband compressor. That includes parametric equalisers, and doesn&amp;rsquo;t have the weird overlapping spectrums that throwing bandpass filters around everywhere does.&lt;sup class=&#34;footnote-ref&#34; id=&#34;fnref:2&#34;&gt;&lt;a href=&#34;#fn:2&#34;&gt;2&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;

&lt;p&gt;To do this, you need to remove the frequencies you want to compress, compress the difference signal, then add it back to the filtered signal. Before, we were adding the difference signal to the dry signal. Now, we&amp;rsquo;re adding the processed difference signal to the wet signal. We could have used the dry signal; we have a choice here between &lt;code&gt;a[n] + compress(b - a)[n]&lt;/code&gt; and &lt;code&gt;b[n] + compress(a - b)[n]&lt;/code&gt;. For compression, I find the latter much easier to reason about. The opposite way still works, but you&amp;rsquo;re adding in a phase-inverted copy of compressed frequencies to the dry signal. I have no intuition for that.&lt;/p&gt;

&lt;h3 id=&#34;compressors&#34;&gt;Compressors&lt;/h3&gt;

&lt;p&gt;The above has a degree of conceptual elegance, which we&amp;rsquo;ll now dispense with. Let&amp;rsquo;s take the signal&lt;/p&gt;

&lt;blockquote&gt;

&lt;span class=&#34;svg&#34;&gt;&lt;svg height=&#34;108pt&#34; version=&#34;1.1&#34; viewBox=&#34;0 0 475.2 108&#34; width=&#34;475.2pt&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; xmlns:xlink=&#34;http://www.w3.org/1999/xlink&#34;&gt;
 &lt;g id=&#34;figure_1&#34;&gt;
  &lt;g id=&#34;patch_1&#34;&gt;
   &lt;path d=&#34;M 0 108
L 475.2 108
L 475.2 0
L 0 0
z
&#34; style=&#34;fill:none;&#34;/&gt;
  &lt;/g&gt;
  &lt;g id=&#34;axes_1&#34;&gt;
   &lt;g id=&#34;line2d_1&#34;&gt;
    &lt;path clip-path=&#34;url(#pc18caf8bee)&#34; d=&#34;M 21.6 54.435059
L 21.913498 23.977661
L 22.226996 72.290588
L 22.540493 76.054504
L 22.853991 34.583862
L 23.167489 26.106812
L 23.480987 61.982666
L 23.794485 76.347839
L 24.107983 61.339966
L 24.42148 65.942688
L 24.734978 78.172119
L 25.048476 67.411011
L 25.361974 32.599731
L 25.675472 40.653259
L 25.98897 35.147461
L 26.302467 23.722229
L 26.615965 25.131226
L 26.929463 54.728394
L 27.242961 73.773743
L 27.556459 68.859558
L 27.869956 68.356934
L 28.183454 80.034302
L 28.496952 77.007019
L 28.81045 56.672974
L 29.123948 49.283569
L 29.437446 55.115662
L 30.064441 29.791626
L 30.377939 27.520752
L 31.004935 50.613464
L 31.318433 54.085693
L 31.63193 65.464783
L 31.945428 72.567444
L 32.258926 74.56311
L 32.572424 68.121277
L 33.199419 62.335327
L 33.826415 42.772522
L 34.139913 36.432861
L 34.453411 34.6745
L 34.766909 34.183411
L 35.080406 39.051453
L 35.707402 62.42926
L 36.0209 67.495056
L 36.334398 69.437988
L 36.647896 72.397705
L 36.961393 72.106018
L 38.528882 34.855774
L 38.84238 31.16272
L 39.155878 35.683044
L 40.409869 68.979858
L 40.723367 72.24939
L 41.036865 71.623169
L 41.350363 68.787048
L 41.663861 63.81189
L 42.604354 41.60907
L 42.917852 36.190613
L 43.23135 33.689026
L 43.544848 35.961548
L 44.171843 53.823669
L 44.798839 68.780457
L 45.112337 72.661377
L 45.425835 73.239807
L 45.739332 69.828552
L 46.679826 47.12146
L 47.306821 32.449768
L 47.620319 32.433289
L 47.933817 38.145081
L 48.874311 65.285156
L 49.187808 70.62616
L 49.501306 72.593811
L 49.814804 71.473206
L 50.128302 67.557678
L 51.695791 34.262512
L 52.009289 33.829102
L 52.322787 38.850403
L 53.576778 70.9953
L 53.890276 73.340332
L 54.203774 72.190063
L 54.517271 67.440674
L 56.084761 31.79718
L 56.398258 34.153748
L 57.025254 51.343506
L 57.65225 67.717529
L 57.965747 71.65448
L 58.279245 72.455383
L 58.592743 70.166382
L 58.906241 64.861633
L 60.160232 36.772339
L 60.47373 33.545654
L 60.787228 35.481995
L 61.100726 42.24353
L 62.041219 68.052063
L 62.354717 72.229614
L 62.668215 73.117859
L 62.981713 70.565186
L 63.608708 56.735596
L 64.549202 33.527527
L 64.8627 32.197632
L 65.176197 36.826721
L 66.430189 69.535217
L 66.743687 72.201599
L 67.057184 71.746765
L 67.370682 68.193787
L 68.938171 35.112854
L 69.251669 33.873596
L 69.565167 37.929199
L 70.819158 69.981812
L 71.132656 72.789917
L 71.446154 72.298828
L 71.759652 68.340454
L 72.700145 45.013733
L 73.013643 37.029419
L 73.327141 32.441528
L 73.640639 33.614868
L 73.954136 40.200073
L 74.89463 66.387634
L 75.208128 70.835449
L 75.521626 72.223022
L 75.835123 70.495972
L 76.148621 65.800964
L 77.402612 38.085754
L 77.71611 34.185059
L 78.029608 35.112854
L 78.343106 41.010864
L 79.283599 66.687561
L 79.597097 71.349609
L 79.910595 72.808044
L 80.224093 70.93103
L 80.537591 65.586731
L 81.791582 34.804688
L 82.10508 32.380554
L 82.418578 35.945068
L 83.672569 68.426147
L 83.986067 71.600098
L 84.299565 71.707214
L 84.613062 68.747498
L 85.240058 55.385925
L 86.180552 36.231812
L 86.494049 34.102661
L 86.807547 37.174438
L 87.434543 53.822021
L 88.061538 68.805176
L 88.375036 72.157104
L 88.688534 72.252686
L 89.002032 68.996338
L 89.629028 54.840454
L 90.569521 33.324829
L 90.883019 33.351196
L 91.196517 38.988831
L 92.13701 65.029724
L 92.450508 69.932373
L 92.764006 71.840698
L 93.077504 70.687134
L 93.391001 66.598572
L 94.644993 39.450256
L 94.958491 34.977722
L 95.271988 34.928284
L 95.585486 39.931458
L 96.52598 65.276917
L 96.839478 70.387207
L 97.152975 72.399353
L 97.466473 71.156799
L 97.779971 66.516174
L 99.34746 32.790894
L 99.660958 35.254578
L 100.287954 51.945007
L 100.914949 67.246216
L 101.228447 70.912903
L 101.541945 71.563843
L 101.855443 69.190796
L 102.16894 63.973389
L 103.109434 43.238892
L 103.422932 37.429871
L 103.73643 34.517944
L 104.049927 36.600952
L 104.363425 43.204285
L 105.303919 67.579102
L 105.617417 71.417175
L 105.930914 72.099426
L 106.244412 69.518738
L 106.871408 56.223083
L 107.811901 34.38446
L 108.125399 33.293518
L 108.438897 37.940735
L 109.692888 68.955139
L 110.006386 71.372681
L 110.319884 70.774475
L 110.633382 67.249512
L 112.200871 35.912109
L 112.514369 34.936523
L 112.827866 39.010254
L 114.081858 69.355591
L 114.395356 71.891785
L 114.708853 71.262268
L 115.022351 67.325317
L 115.962845 45.129089
L 116.276343 37.673767
L 116.58984 33.422058
L 116.903338 34.758545
L 117.216836 41.230042
L 118.157329 66.025085
L 118.470827 70.131775
L 118.784325 71.310059
L 119.097823 69.515442
L 119.411321 64.909424
L 120.665312 38.682312
L 120.97881 35.104614
L 121.292308 36.215332
L 121.605806 42.011169
L 122.546299 66.292053
L 122.859797 70.599792
L 123.173295 71.837402
L 123.486792 69.891174
L 123.80029 64.658936
L 125.054282 35.587463
L 125.367779 33.448425
L 125.681277 37.06897
L 126.935269 67.911987
L 127.248766 70.81073
L 127.562264 70.759644
L 127.875762 67.791687
L 128.502758 54.997009
L 129.443251 37.016235
L 129.756749 36.319153
L 130.070247 23.44043
L 130.383745 73.510071
L 130.697242 42.154541
L 131.01074 29.643311
L 131.324238 72.394409
L 131.637736 83.984436
L 131.951234 53.873108
L 132.264731 70.850281
L 132.578229 74.243408
L 132.891727 70.543762
L 133.205225 43.604736
L 133.518723 28.094238
L 133.832221 45.16864
L 134.145718 43.184509
L 134.459216 39.524414
L 134.772714 50.425598
L 135.086212 66.605164
L 135.39971 68.622253
L 135.713208 62.149109
L 136.026705 63.617432
L 136.340203 77.613464
L 136.653701 69.91095
L 136.967199 47.409851
L 137.280697 50.087769
L 137.594194 53.822021
L 137.907692 39.873779
L 138.22119 34.857422
L 138.534688 34.466858
L 138.848186 46.276062
L 139.161684 48.515625
L 139.475181 53.227112
L 140.102177 70.909607
L 140.415675 67.453857
L 141.042671 63.907471
L 141.356168 59.225647
L 141.983164 43.642639
L 142.61016 38.154968
L 142.923657 37.240356
L 143.237155 42.69342
L 143.864151 59.71344
L 144.804644 70.301514
L 145.118142 68.422852
L 146.685631 40.015503
L 146.999129 37.677063
L 147.312627 39.425537
L 147.939623 49.372559
L 148.566618 64.855042
L 148.880116 68.202026
L 149.193614 68.726074
L 149.507112 68.165771
L 149.82061 64.653992
L 150.761103 44.432007
L 151.074601 39.173401
L 151.388099 36.363647
L 151.701597 38.250549
L 153.269086 68.477234
L 153.582583 69.390198
L 153.896081 67.157227
L 154.523077 57.243164
L 155.46357 40.341797
L 155.777068 37.874817
L 156.090566 39.13385
L 156.404064 43.840393
L 157.344557 64.668823
L 157.658055 68.338806
L 157.971553 69.50061
L 158.285051 67.879028
L 158.598549 63.264771
L 159.85254 38.402161
L 160.166038 36.460876
L 160.479536 39.267334
L 162.047025 68.55304
L 162.360522 68.991394
L 162.67402 66.868835
L 162.987518 62.473755
L 164.241509 40.089661
L 164.555007 37.828674
L 164.868505 39.501343
L 165.182003 44.585266
L 166.122496 64.690247
L 166.435994 68.121277
L 166.749492 68.965027
L 167.06299 67.124268
L 167.376488 62.813232
L 168.630479 40.439026
L 168.943977 37.879761
L 169.257475 39.267334
L 169.570972 44.115601
L 170.511466 64.301331
L 170.824964 67.890564
L 171.138462 68.892517
L 171.451959 67.297302
L 171.765457 63.264771
L 173.019448 40.859253
L 173.332946 38.036316
L 173.646444 39.049805
L 173.959942 43.647583
L 174.900435 63.833313
L 175.213933 67.62854
L 175.527431 68.869446
L 175.840929 67.476929
L 176.154427 63.627319
L 177.408418 41.277832
L 177.721916 38.204407
L 178.035414 38.889954
L 178.348911 43.227356
L 179.289405 63.365295
L 179.602903 67.346741
L 179.916401 68.787048
L 180.229898 67.608765
L 180.543396 63.97998
L 181.797388 41.709595
L 182.110885 38.400513
L 182.424383 38.766357
L 182.737881 42.825256
L 183.991872 67.03363
L 184.30537 68.686523
L 184.618868 67.727417
L 184.932366 64.314514
L 186.499855 38.644409
L 186.813353 38.66748
L 187.126851 42.441284
L 188.380842 66.710632
L 188.69434 68.567871
L 189.007837 67.834534
L 189.321335 64.616089
L 190.888824 38.911377
L 191.202322 38.591675
L 191.51582 42.088623
L 192.769811 66.377747
L 193.083309 68.426147
L 193.396807 67.908691
L 193.710305 64.90448
L 195.277794 39.657898
L 195.591292 39.280518
L 195.90479 42.306152
L 197.158781 64.439758
L 197.472279 66.908386
L 197.785776 67.10614
L 198.099274 64.988525
L 198.72627 55.412292
L 199.353266 45.424072
L 199.666763 41.707947
L 199.980261 40.17865
L 200.293759 41.750793
L 200.607257 45.94812
L 201.54775 62.979675
L 201.861248 66.173401
L 202.174746 67.120972
L 202.488244 65.744934
L 202.801742 62.241394
L 204.055733 42.777466
L 204.369231 40.409363
L 204.682729 41.012512
L 204.996226 44.473206
L 206.250218 65.342834
L 206.563716 66.995728
L 206.877213 66.344788
L 207.190711 63.47406
L 208.7582 40.954834
L 209.071698 40.570862
L 209.385196 43.205933
L 210.012192 54.131836
L 210.639187 64.289795
L 210.952685 66.652954
L 211.266183 66.718872
L 211.579681 64.525452
L 212.206676 55.025024
L 212.833672 45.308716
L 213.14717 41.757385
L 213.460668 40.424194
L 213.774165 42.159485
L 214.087663 46.419434
L 215.028157 63.067017
L 215.341655 66.082764
L 215.655152 66.868835
L 215.96865 65.36261
L 216.282148 61.806335
L 217.536139 42.770874
L 217.849637 40.607117
L 218.163135 41.375061
L 218.476633 44.934631
L 219.730624 65.304932
L 220.044122 66.788086
L 220.35762 65.998718
L 220.671118 63.062073
L 222.238607 41.075134
L 222.552104 40.882324
L 222.865602 43.650879
L 223.492598 54.51416
L 224.119594 64.322754
L 224.433091 66.489807
L 224.746589 66.418945
L 225.060087 64.126648
L 225.687083 54.70697
L 226.314078 45.244446
L 226.627576 42.091919
L 226.941074 41.254761
L 227.254572 43.144958
L 227.881567 52.389954
L 228.508563 62.017273
L 228.822061 64.818787
L 229.135559 65.654297
L 229.449057 64.444702
L 229.762554 61.369629
L 231.016546 44.278748
L 231.330044 42.327576
L 231.643541 42.70166
L 231.957039 45.404297
L 233.21103 63.513611
L 233.524528 65.342834
L 233.838026 65.133545
L 234.151524 62.94342
L 234.77852 54.318054
L 235.405515 45.822876
L 235.719013 43.062561
L 236.032511 42.296265
L 236.346009 43.932678
L 236.973004 52.480591
L 237.6 61.939819
L 237.913498 50.125671
L 238.226996 86.072388
L 238.853991 25.360291
L 239.480987 80.060669
L 240.107983 24.061707
L 240.42148 53.874756
L 240.734978 67.574158
L 241.048476 60.094116
L 241.361974 35.631958
L 241.675472 49.283569
L 241.98897 68.526672
L 242.302467 66.31842
L 242.615965 45.532837
L 242.929463 70.787659
L 243.242961 67.364868
L 243.869956 36.708069
L 244.496952 56.318665
L 245.123948 34.928284
L 245.437446 53.657227
L 245.750943 52.839844
L 246.064441 43.74646
L 246.377939 52.668457
L 246.691437 67.083069
L 247.004935 66.743591
L 247.318433 62.674805
L 247.63193 61.218018
L 247.945428 62.8396
L 248.258926 58.278076
L 248.572424 50.188293
L 248.885922 47.309326
L 249.199419 47.200562
L 249.512917 45.069763
L 249.826415 41.063599
L 250.139913 44.201294
L 250.453411 52.594299
L 250.766909 56.938293
L 251.080406 57.740845
L 251.707402 67.261047
L 252.0209 64.434814
L 252.334398 60.019958
L 252.647896 58.220398
L 252.961393 55.466675
L 253.588389 44.603394
L 253.901887 43.013123
L 254.215385 44.20459
L 254.528882 44.133728
L 254.84238 47.485657
L 255.469376 58.983398
L 256.409869 65.135193
L 256.723367 64.095337
L 257.977358 47.907532
L 258.290856 44.029907
L 258.604354 42.836792
L 258.917852 44.412231
L 259.544848 50.550842
L 260.171843 59.901306
L 260.485341 62.819824
L 260.798839 63.754211
L 261.112337 63.582825
L 261.425835 61.982666
L 262.993324 44.425415
L 263.306821 43.624512
L 263.620319 45.409241
L 264.247315 52.727783
L 264.874311 60.970825
L 265.187808 63.488892
L 265.501306 63.938782
L 265.814804 62.854431
L 266.128302 60.290222
L 267.382293 45.595459
L 267.695791 44.089233
L 268.009289 44.298523
L 268.322787 46.538086
L 269.576778 62.05188
L 269.890276 63.85968
L 270.203774 63.762451
L 270.517271 61.877197
L 271.144267 54.627869
L 271.771263 47.035767
L 272.084761 44.670959
L 272.398258 44.001892
L 272.711756 45.181824
L 273.025254 48.036072
L 274.279245 62.950012
L 274.592743 63.953613
L 274.906241 63.154358
L 275.219739 60.647827
L 276.47373 45.934937
L 276.787228 44.160095
L 277.100726 44.303467
L 277.414224 46.26947
L 278.041219 53.990112
L 278.668215 61.653076
L 278.981713 63.569641
L 279.29521 63.750916
L 279.608708 62.193604
L 280.235704 55.155212
L 280.8627 47.57959
L 281.176197 45.0401
L 281.489695 44.036499
L 281.803193 44.969238
L 282.116691 47.629028
L 283.370682 62.628662
L 283.68418 63.815186
L 283.997678 63.243347
L 284.311176 61.016968
L 285.878665 44.446838
L 286.192163 44.267212
L 286.50566 45.967896
L 287.132656 53.383667
L 287.759652 61.161987
L 288.073149 63.297729
L 288.386647 63.737732
L 288.700145 62.42926
L 289.013643 59.601379
L 290.267634 45.534485
L 290.581132 44.489685
L 290.89463 45.236206
L 291.208128 47.605957
L 292.462119 61.504761
L 292.775617 62.864319
L 293.089115 62.648438
L 293.402612 60.888428
L 294.029608 54.229065
L 294.656604 47.582886
L 294.970102 45.636658
L 295.283599 45.173584
L 295.597097 46.33374
L 295.910595 48.930908
L 297.164586 62.05188
L 297.478084 62.862671
L 297.791582 62.074951
L 298.10508 59.830444
L 299.359071 46.742432
L 299.672569 45.321899
L 299.986067 45.453735
L 300.299565 47.184082
L 300.92656 53.945618
L 301.553556 60.731873
L 301.867054 62.491882
L 302.180552 62.71106
L 302.494049 61.359741
L 303.121045 55.163452
L 303.748041 48.331055
L 304.061538 46.09314
L 304.375036 45.22467
L 304.688534 45.969543
L 305.002032 48.212402
L 306.256023 61.519592
L 306.569521 62.71106
L 306.883019 62.335327
L 307.196517 60.461609
L 308.764006 45.631714
L 309.077504 45.359802
L 309.391001 46.67981
L 310.017997 52.960144
L 310.644993 59.995239
L 310.958491 62.094727
L 311.271988 62.714355
L 311.585486 61.756897
L 311.898984 59.410217
L 313.152975 46.627075
L 313.466473 45.392761
L 313.779971 45.710815
L 314.093469 47.577942
L 314.720464 54.38562
L 315.34746 60.893372
L 315.660958 62.460571
L 315.974456 62.495178
L 316.287954 61.000488
L 316.914949 54.726746
L 317.541945 48.106934
L 317.855443 46.048645
L 318.16894 45.366394
L 318.482438 46.27771
L 318.795936 48.632629
L 320.049927 61.603638
L 320.363425 62.617126
L 320.676923 62.056824
L 320.990421 60.067749
L 322.244412 47.299438
L 322.55791 45.847595
L 322.871408 45.880554
L 323.184906 47.385132
L 323.811901 53.441345
L 324.438897 59.683777
L 324.752395 61.455322
L 325.065893 61.868958
L 325.37939 60.899963
L 325.692888 58.686768
L 326.94688 47.248352
L 327.260377 46.262878
L 327.573875 46.648499
L 327.887373 48.392029
L 328.514369 54.500977
L 329.141364 60.285278
L 329.454862 61.651428
L 329.76836 61.616821
L 330.081858 60.229248
L 330.708853 54.533936
L 331.335849 48.609558
L 331.649347 46.809998
L 331.962845 46.274414
L 332.276343 47.12146
L 332.58984 49.235779
L 333.843832 60.834045
L 334.157329 61.748657
L 334.470827 61.269104
L 334.784325 59.467896
L 336.351814 46.52655
L 336.665312 46.445801
L 336.97881 47.721313
L 337.605806 53.337524
L 338.232801 59.461304
L 338.546299 61.250977
L 338.859797 61.702515
L 339.173295 60.773071
L 339.486792 58.619202
L 340.740784 47.363708
L 341.054282 46.386475
L 341.367779 46.757263
L 341.681277 48.453003
L 342.308273 54.451538
L 342.935269 60.153442
L 343.248766 61.517944
L 343.562264 61.508057
L 343.875762 60.150146
L 344.502758 54.565247
L 345.129753 48.769409
L 345.443251 47.014343
L 345.756749 54.983826
L 346.070247 49.567017
L 346.383745 70.973877
L 346.697242 34.241089
L 347.01074 48.395325
L 347.324238 54.973938
L 347.637736 84.618896
L 348.264731 26.723145
L 348.891727 83.315369
L 349.205225 42.159485
L 349.832221 55.110718
L 350.145718 61.155396
L 350.459216 33.422058
L 351.086212 52.404785
L 351.39971 58.024292
L 351.713208 42.17926
L 352.340203 64.892944
L 352.653701 63.291138
L 352.967199 51.816467
L 353.280697 54.939331
L 353.594194 61.600342
L 353.907692 55.216187
L 354.22119 42.337463
L 354.848186 53.14801
L 355.161684 46.602356
L 355.475181 43.898071
L 356.102177 59.294861
L 356.415675 55.344727
L 356.729173 54.791016
L 357.042671 62.526489
L 357.356168 64.868225
L 357.669666 58.40332
L 357.983164 54.411987
L 358.296662 55.247498
L 358.61016 55.273865
L 358.923657 47.714722
L 359.237155 45.463623
L 359.550653 48.657349
L 359.864151 50.252563
L 360.177649 48.441467
L 360.491147 50.786499
L 360.804644 56.473572
L 361.118142 58.927368
L 361.43164 59.133362
L 361.745138 59.952393
L 362.058636 61.620117
L 362.372134 59.423401
L 362.685631 55.610046
L 363.626125 49.054504
L 363.939623 46.546326
L 364.25312 47.109924
L 365.507112 55.970947
L 365.82061 59.397034
L 366.134107 60.527527
L 366.761103 60.166626
L 367.074601 58.734558
L 367.701597 52.442688
L 368.015094 50.152039
L 368.64209 47.179138
L 368.955588 47.182434
L 369.582583 51.623657
L 370.836575 60.834045
L 371.150073 60.509399
L 371.46357 59.357483
L 371.777068 57.531555
L 372.717562 49.421997
L 373.03106 47.968506
L 373.344557 47.38678
L 373.658055 47.754272
L 373.971553 49.53241
L 375.225544 59.790894
L 375.539042 60.832397
L 375.85254 60.431946
L 376.166038 58.879578
L 376.793033 53.947266
L 377.420029 48.827087
L 377.733527 47.594421
L 378.047025 47.446106
L 378.360522 48.352478
L 378.67402 50.318481
L 379.614514 58.469238
L 379.928012 60.160034
L 380.241509 60.763184
L 380.555007 60.110596
L 380.868505 58.273132
L 382.122496 48.364014
L 382.435994 47.385132
L 382.749492 47.604309
L 383.06299 48.942444
L 383.689985 53.99176
L 384.316981 59.120178
L 384.630479 60.456665
L 384.943977 60.6297
L 385.257475 59.612915
L 385.88447 54.886597
L 386.511466 49.7005
L 386.824964 48.092102
L 387.138462 47.541687
L 387.451959 48.167908
L 387.765457 49.848816
L 389.019448 59.232239
L 389.332946 60.09906
L 389.646444 59.876587
L 389.959942 58.619202
L 390.586938 54.016479
L 391.213933 49.497803
L 391.527431 48.250305
L 391.840929 48.011353
L 392.154427 48.838623
L 392.467925 50.598633
L 393.721916 59.509094
L 394.035414 60.075989
L 394.348911 59.548645
L 394.662409 58.00946
L 395.916401 49.038025
L 396.229898 48.083862
L 396.543396 48.181091
L 396.856894 49.318176
L 397.48389 53.823669
L 398.110885 58.507141
L 398.424383 59.781006
L 398.737881 60.000183
L 399.051379 59.131714
L 399.678374 54.97229
L 400.30537 50.227844
L 400.618868 48.665588
L 400.932366 48.02948
L 401.245864 48.457947
L 401.559361 49.881775
L 402.813353 58.985046
L 403.126851 59.940857
L 403.440348 59.812317
L 403.753846 58.632385
L 404.380842 54.171387
L 405.007837 49.667542
L 405.321335 48.385437
L 405.634833 48.077271
L 405.948331 48.841919
L 406.261829 50.527771
L 407.51582 59.369019
L 407.829318 59.988647
L 408.142816 59.518982
L 408.456313 58.060547
L 409.710305 49.192932
L 410.023803 48.197571
L 410.3373 48.232178
L 410.650798 49.304993
L 411.277794 53.683594
L 411.90479 58.343994
L 412.218287 59.655762
L 412.531785 59.930969
L 412.845283 59.12677
L 413.472279 55.094238
L 414.099274 50.390991
L 414.412772 48.810608
L 414.72627 48.120117
L 415.039768 48.48761
L 415.353266 49.847168
L 416.920755 59.830444
L 417.234253 59.754639
L 417.54775 58.657104
L 418.174746 54.31311
L 418.801742 49.855408
L 419.115239 48.604614
L 419.428737 48.324463
L 419.742235 49.059448
L 420.055733 50.672791
L 421.309724 58.831787
L 421.623222 59.431641
L 421.93672 59.059204
L 422.250218 57.7771
L 423.504209 49.749939
L 423.817707 48.805664
L 424.131205 48.767761
L 424.444702 49.677429
L 425.071698 53.548462
L 425.698694 57.790283
L 426.012192 59.041077
L 426.325689 59.359131
L 426.639187 58.711487
L 426.952685 57.218445
L 428.206676 49.397278
L 428.520174 48.719971
L 428.833672 48.965515
L 429.14717 50.122375
L 429.774165 54.237305
L 430.401161 58.233582
L 430.714659 59.215759
L 431.028157 59.242126
L 431.341655 58.325867
L 431.96865 54.484497
L 432.595646 50.386047
L 432.909144 49.123718
L 433.222642 48.719971
L 433.536139 49.252258
L 433.849637 50.644775
L 435.103628 58.591187
L 435.417126 59.303101
L 435.730624 59.032837
L 436.044122 57.872681
L 437.611611 48.925964
L 437.925109 48.810608
L 438.238607 49.603271
L 438.865602 53.325989
L 439.492598 57.56781
L 439.806096 58.889465
L 440.119594 59.296509
L 440.433091 58.74939
L 440.746589 57.346985
L 442.000581 49.581848
L 442.314078 48.815552
L 442.627576 48.975403
L 442.941074 50.028442
L 443.56807 54.013184
L 444.195065 58.02594
L 444.508563 59.087219
L 444.822061 59.205872
L 445.135559 58.396729
L 445.762554 54.688843
L 446.38955 50.595337
L 446.703048 49.280273
L 447.016546 48.797424
L 447.330044 49.227539
L 447.643541 50.511292
L 448.897533 58.413208
L 449.21103 59.197632
L 449.524528 59.037781
L 449.838026 57.963318
L 450.465022 54.023071
L 451.092017 50.150391
L 451.405515 49.06604
L 451.719013 48.843567
L 452.032511 49.550537
L 452.346009 51.050171
L 453.6 58.630737
L 453.6 58.630737
&#34; style=&#34;fill:none;stroke:#e61ae6;stroke-linecap:square;stroke-width:1.5;&#34;/&gt;
   &lt;/g&gt;
  &lt;/g&gt;
 &lt;/g&gt;
 &lt;defs&gt;
  &lt;clipPath id=&#34;pc18caf8bee&#34;&gt;
   &lt;rect height=&#34;108&#34; width=&#34;475.2&#34; x=&#34;0&#34; y=&#34;0&#34;/&gt;
  &lt;/clipPath&gt;
 &lt;/defs&gt;
&lt;/svg&gt;
&lt;/span&gt;


&lt;/blockquote&gt;

&lt;p&gt;and use a compressor to flatten its peaks.&lt;/p&gt;

&lt;blockquote&gt;

&lt;span class=&#34;svg&#34;&gt;&lt;svg height=&#34;108pt&#34; version=&#34;1.1&#34; viewBox=&#34;0 0 475.2 108&#34; width=&#34;475.2pt&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; xmlns:xlink=&#34;http://www.w3.org/1999/xlink&#34;&gt;
 &lt;g id=&#34;figure_1&#34;&gt;
  &lt;g id=&#34;patch_1&#34;&gt;
   &lt;path d=&#34;M 0 108
L 475.2 108
L 475.2 0
L 0 0
z
&#34; style=&#34;fill:none;&#34;/&gt;
  &lt;/g&gt;
  &lt;g id=&#34;axes_1&#34;&gt;
   &lt;g id=&#34;line2d_1&#34;&gt;
    &lt;path clip-path=&#34;url(#p629da2a526)&#34; d=&#34;M 21.6 54.453186
L 21.913498 31.101746
L 22.226996 66.760071
L 22.540493 68.671692
L 22.853991 40.888916
L 23.167489 35.254578
L 23.480987 59.451416
L 23.794485 69.487427
L 24.107983 59.166321
L 24.42148 62.539673
L 24.734978 71.189758
L 25.048476 63.600952
L 25.361974 38.446655
L 25.675472 44.155151
L 25.98897 39.890259
L 26.302467 31.584595
L 26.615965 33.746704
L 27.242961 68.312439
L 27.556459 64.927551
L 27.869956 64.710022
L 28.183454 73.681458
L 28.496952 71.553955
L 28.81045 56.066528
L 29.123948 50.315186
L 29.437446 54.876709
L 30.064441 34.455322
L 30.377939 32.876587
L 31.004935 51.251221
L 31.318433 54.070862
L 31.63193 63.508667
L 31.945428 69.531921
L 32.258926 71.346313
L 32.572424 66.003662
L 33.199419 61.190002
L 34.139913 38.532349
L 34.453411 36.872864
L 34.766909 36.348816
L 35.080406 40.612061
L 35.707402 61.621765
L 36.0209 66.267334
L 36.334398 68.103149
L 36.647896 70.876648
L 36.961393 70.677246
L 38.528882 36.043945
L 38.84238 32.522278
L 39.155878 36.736084
L 40.409869 68.274536
L 40.723367 71.423767
L 41.036865 70.86676
L 41.350363 68.174011
L 41.663861 63.434509
L 42.604354 42.030945
L 42.917852 36.777283
L 43.23135 34.307007
L 43.544848 36.495483
L 43.858345 43.845337
L 44.485341 62.271057
L 44.798839 68.417908
L 45.112337 72.236206
L 45.425835 72.804749
L 45.739332 69.50061
L 46.679826 47.245056
L 47.306821 32.800781
L 47.620319 32.767822
L 47.933817 38.387329
L 48.874311 65.143433
L 49.187808 70.426758
L 49.501306 72.363098
L 49.814804 71.272156
L 50.128302 67.412659
L 51.695791 34.435547
L 52.009289 33.988953
L 52.322787 38.967407
L 53.576778 70.891479
L 53.890276 73.228271
L 54.203774 72.079651
L 54.517271 67.366516
L 56.084761 31.896057
L 56.398258 34.239441
L 57.025254 51.353394
L 57.65225 67.677979
L 57.965747 71.59845
L 58.279245 72.407593
L 58.592743 70.112
L 58.906241 64.827026
L 60.160232 36.813538
L 60.47373 33.591797
L 60.787228 35.519897
L 61.100726 42.271545
L 62.041219 68.03064
L 62.354717 72.198303
L 62.668215 73.083252
L 62.981713 70.533875
L 63.608708 56.730652
L 64.549202 33.542358
L 64.8627 32.220703
L 65.176197 36.841553
L 66.430189 69.523682
L 66.743687 72.195007
L 67.057184 71.728638
L 67.370682 68.183899
L 68.938171 35.11615
L 69.251669 33.891724
L 69.565167 37.934143
L 70.819158 69.970276
L 71.132656 72.793213
L 71.446154 72.290588
L 71.759652 68.330566
L 72.700145 45.015381
L 73.013643 37.037659
L 73.327141 32.451416
L 73.640639 33.623108
L 73.954136 40.198425
L 74.89463 66.377747
L 75.208128 70.828857
L 75.521626 72.209839
L 75.835123 70.491028
L 76.148621 65.792725
L 77.402612 38.085754
L 77.71611 34.185059
L 78.029608 35.121094
L 78.343106 41.012512
L 79.283599 66.690857
L 79.597097 71.343018
L 79.910595 72.799805
L 80.224093 70.93103
L 80.537591 65.581787
L 81.791582 34.804688
L 82.10508 32.380554
L 82.418578 35.945068
L 83.672569 68.421204
L 83.986067 71.59845
L 84.299565 71.702271
L 84.613062 68.754089
L 85.240058 55.382629
L 86.180552 36.221924
L 86.494049 34.109253
L 86.807547 37.171143
L 87.434543 53.831909
L 88.061538 68.808472
L 88.375036 72.150513
L 88.688534 72.255981
L 89.002032 68.99469
L 89.629028 54.838806
L 90.569521 33.321533
L 90.883019 33.349548
L 91.196517 38.985535
L 92.13701 65.026428
L 92.450508 69.932373
L 92.764006 71.837402
L 93.077504 70.69043
L 93.391001 66.603516
L 94.644993 39.445312
L 94.958491 34.97937
L 95.271988 34.93158
L 95.585486 39.924866
L 96.52598 65.276917
L 96.839478 70.388855
L 97.152975 72.401001
L 97.466473 71.156799
L 97.779971 66.522766
L 99.34746 32.794189
L 99.660958 35.249634
L 100.287954 51.949951
L 100.914949 67.252808
L 101.228447 70.907959
L 101.541945 71.557251
L 101.855443 69.189148
L 102.16894 63.971741
L 103.109434 43.227356
L 103.422932 37.428223
L 103.73643 34.514648
L 104.049927 36.604248
L 104.363425 43.204285
L 105.303919 67.577454
L 105.617417 71.415527
L 105.930914 72.10437
L 106.244412 69.51709
L 106.871408 56.224731
L 107.811901 34.377869
L 108.125399 33.298462
L 108.438897 37.947327
L 109.692888 68.960083
L 110.006386 71.372681
L 110.319884 70.782715
L 110.633382 67.246216
L 112.200871 35.915405
L 112.514369 34.93158
L 112.827866 39.006958
L 114.081858 69.353943
L 114.395356 71.891785
L 114.708853 71.258972
L 115.022351 67.328613
L 115.962845 45.129089
L 116.276343 37.667175
L 116.58984 33.413818
L 116.903338 34.768433
L 117.216836 41.221802
L 118.157329 66.023438
L 118.470827 70.133423
L 118.784325 71.306763
L 119.097823 69.518738
L 119.411321 64.914368
L 120.665312 38.685608
L 120.97881 35.101318
L 121.292308 36.213684
L 121.605806 42.011169
L 122.546299 66.292053
L 122.859797 70.596497
L 123.173295 71.840698
L 123.486792 69.892822
L 123.80029 64.658936
L 125.054282 35.585815
L 125.367779 33.450073
L 125.681277 37.080505
L 126.935269 67.915283
L 127.248766 70.807434
L 127.562264 70.756348
L 127.875762 67.798279
L 128.502758 55.000305
L 129.443251 36.99646
L 129.756749 36.282898
L 130.070247 33.512695
L 130.383745 67.300598
L 130.697242 45.81134
L 131.01074 36.922302
L 131.324238 67.10614
L 131.637736 73.917114
L 131.951234 53.909363
L 132.264731 65.578491
L 132.578229 68.15094
L 132.891727 65.735046
L 133.205225 46.505127
L 133.518723 35.093079
L 133.832221 47.469177
L 134.145718 45.87561
L 134.459216 43.011475
L 134.772714 51.251221
L 135.086212 63.797058
L 135.39971 65.496094
L 135.713208 60.479736
L 136.026705 61.73053
L 136.340203 73.177185
L 136.653701 67.055054
L 136.967199 48.545288
L 137.280697 50.735413
L 137.594194 53.848389
L 137.907692 42.007874
L 138.22119 37.625977
L 138.534688 37.171143
L 138.848186 47.301086
L 139.161684 49.199524
L 139.475181 53.327637
L 140.102177 69.044128
L 140.415675 66.033325
L 141.042671 62.954956
L 141.356168 58.74115
L 141.983164 44.512756
L 142.61016 39.364563
L 142.923657 38.453247
L 143.237155 43.484436
L 143.864151 59.350891
L 144.804644 69.398438
L 145.118142 67.676331
L 146.685631 40.597229
L 146.999129 38.323059
L 147.312627 39.9776
L 147.939623 49.53241
L 148.566618 64.51886
L 148.880116 67.786743
L 149.193614 68.304199
L 149.507112 67.783447
L 149.82061 64.372192
L 150.761103 44.651184
L 151.074601 39.494751
L 151.388099 36.713013
L 151.701597 38.552124
L 153.269086 68.254761
L 153.582583 69.172668
L 153.896081 66.971008
L 154.523077 57.206909
L 155.46357 40.496704
L 155.777068 38.051147
L 156.090566 39.277222
L 156.404064 43.935974
L 157.344557 64.584778
L 157.658055 68.230042
L 157.971553 69.38855
L 158.285051 67.786743
L 158.598549 63.2005
L 159.85254 38.49115
L 160.166038 36.55481
L 160.479536 39.339844
L 162.047025 68.490417
L 162.360522 68.935364
L 162.67402 66.822693
L 162.987518 62.439148
L 164.241509 40.132507
L 164.555007 37.878113
L 164.868505 39.539246
L 165.182003 44.609985
L 166.122496 64.665527
L 166.435994 68.088318
L 166.749492 68.93042
L 167.06299 67.099548
L 167.376488 62.800049
L 168.630479 40.452209
L 168.943977 37.90448
L 169.257475 39.282166
L 169.570972 44.127136
L 170.511466 64.279907
L 170.824964 67.87738
L 171.138462 68.879333
L 171.451959 67.289062
L 171.765457 63.256531
L 173.019448 40.870789
L 173.332946 38.037964
L 173.646444 39.059692
L 173.959942 43.66571
L 174.900435 63.828369
L 175.213933 67.625244
L 175.527431 68.861206
L 175.840929 67.463745
L 176.154427 63.624023
L 177.408418 41.277832
L 177.721916 38.206055
L 178.035414 38.894897
L 178.348911 43.225708
L 179.289405 63.360352
L 179.602903 67.338501
L 179.916401 68.782104
L 180.229898 67.615356
L 180.543396 63.978333
L 181.797388 41.707947
L 182.110885 38.412048
L 182.424383 38.769653
L 182.737881 42.815369
L 183.991872 67.036926
L 184.30537 68.688171
L 184.618868 67.734009
L 184.932366 64.30957
L 186.499855 38.639465
L 186.813353 38.66748
L 187.126851 42.446228
L 188.380842 66.715576
L 188.69434 68.571167
L 189.007837 67.822998
L 189.321335 64.617737
L 190.888824 38.906433
L 191.202322 38.598267
L 191.51582 42.091919
L 192.769811 66.372803
L 193.083309 68.434387
L 193.396807 67.907043
L 193.710305 64.897888
L 195.277794 39.66449
L 195.591292 39.282166
L 195.90479 42.3078
L 197.158781 64.447998
L 197.472279 66.910034
L 197.785776 67.099548
L 198.099274 64.991821
L 198.72627 55.418884
L 199.353266 45.415833
L 199.666763 41.716187
L 199.980261 40.183594
L 200.293759 41.754089
L 200.607257 45.944824
L 201.54775 62.979675
L 201.861248 66.175049
L 202.174746 67.127563
L 202.488244 65.743286
L 202.801742 62.241394
L 204.055733 42.777466
L 204.369231 40.414307
L 204.682729 41.00592
L 204.996226 44.468262
L 206.250218 65.336243
L 206.563716 66.99408
L 206.877213 66.346436
L 207.190711 63.483948
L 208.7582 40.954834
L 209.071698 40.56427
L 209.385196 43.205933
L 210.012192 54.133484
L 210.639187 64.296387
L 210.952685 66.641418
L 211.266183 66.717224
L 211.579681 64.5271
L 212.206676 55.023376
L 212.833672 45.300476
L 213.14717 41.752441
L 213.460668 40.429138
L 213.774165 42.161133
L 214.087663 46.417786
L 215.028157 63.070312
L 215.341655 66.07782
L 215.655152 66.860596
L 215.96865 65.377441
L 216.282148 61.807983
L 217.536139 42.770874
L 217.849637 40.605469
L 218.163135 41.378357
L 218.476633 44.931335
L 219.730624 65.296692
L 220.044122 66.789734
L 220.35762 66.00531
L 220.671118 63.057129
L 222.238607 41.066895
L 222.552104 40.880676
L 222.865602 43.649231
L 223.492598 54.515808
L 224.119594 64.314514
L 224.433091 66.491455
L 224.746589 66.414001
L 225.060087 64.125
L 225.687083 54.708618
L 226.314078 45.246094
L 226.627576 42.091919
L 226.941074 41.259705
L 227.254572 43.149902
L 227.881567 52.388306
L 228.508563 62.028809
L 228.822061 64.808899
L 229.135559 65.646057
L 229.449057 64.443054
L 229.762554 61.361389
L 231.016546 44.267212
L 231.330044 42.320984
L 231.643541 42.708252
L 231.957039 45.402649
L 233.21103 63.513611
L 233.524528 65.34613
L 233.838026 65.136841
L 234.151524 62.938477
L 234.77852 54.316406
L 235.405515 45.821228
L 235.719013 43.060913
L 236.032511 42.296265
L 236.346009 43.934326
L 236.973004 52.482239
L 237.6 61.934875
L 237.913498 50.096008
L 238.226996 78.183655
L 238.540493 50.924927
L 238.853991 34.2724
L 239.167489 50.506348
L 239.480987 72.516357
L 240.107983 32.306396
L 240.42148 53.914307
L 240.734978 64.039307
L 241.048476 58.569763
L 241.361974 40.046814
L 241.675472 50.377808
L 241.98897 65.295044
L 242.302467 63.693237
L 242.615965 47.259888
L 242.929463 67.506592
L 243.242961 64.846802
L 243.869956 39.699097
L 244.496952 55.954468
L 245.123948 37.690247
L 245.437446 53.708313
L 245.750943 52.993103
L 246.064441 45.045044
L 246.377939 52.828308
L 246.691437 65.565308
L 247.004935 65.334595
L 247.318433 61.758545
L 247.63193 60.497864
L 247.945428 61.98761
L 248.258926 57.887512
L 248.572424 50.521179
L 248.885922 47.874573
L 249.199419 47.739441
L 249.512917 45.745422
L 249.826415 41.997986
L 250.139913 44.880249
L 250.453411 52.691528
L 250.766909 56.760315
L 251.080406 57.523315
L 251.707402 66.542542
L 252.0209 63.881104
L 252.334398 59.720032
L 252.647896 58.0177
L 252.961393 55.394165
L 253.588389 44.993958
L 253.901887 43.448181
L 254.215385 44.577026
L 254.528882 44.494629
L 254.84238 47.703186
L 255.469376 58.825195
L 256.409869 64.833618
L 256.723367 63.836609
L 257.977358 48.034424
L 258.290856 44.234253
L 258.604354 43.051025
L 258.917852 44.585266
L 259.544848 50.605225
L 260.171843 59.807373
L 260.485341 62.691284
L 260.798839 63.620728
L 261.112337 63.454285
L 261.425835 61.883789
L 262.993324 44.5177
L 263.306821 43.725037
L 263.620319 45.486694
L 264.247315 52.731079
L 264.874311 60.926331
L 265.187808 63.42627
L 265.501306 63.872864
L 265.814804 62.786865
L 266.128302 60.245728
L 267.382293 45.64325
L 267.695791 44.143616
L 268.009289 44.339722
L 268.322787 46.571045
L 269.576778 62.022217
L 269.890276 63.823425
L 270.203774 63.727844
L 270.517271 61.854126
L 271.144267 54.624573
L 271.771263 47.047302
L 272.084761 44.690735
L 272.398258 44.02002
L 272.711756 45.195007
L 273.025254 48.044312
L 274.279245 62.940125
L 274.592743 63.943726
L 274.906241 63.142822
L 275.219739 60.637939
L 276.47373 45.946472
L 276.787228 44.176575
L 277.100726 44.306763
L 277.414224 46.281006
L 278.041219 53.985168
L 278.668215 61.644836
L 278.981713 63.559753
L 279.29521 63.744324
L 279.608708 62.187012
L 280.235704 55.161804
L 280.8627 47.589478
L 281.176197 45.043396
L 281.489695 44.043091
L 281.803193 44.972534
L 282.116691 47.63562
L 283.370682 62.63031
L 283.68418 63.815186
L 283.997678 63.235107
L 284.311176 61.012024
L 285.878665 44.441895
L 286.192163 44.270508
L 286.50566 45.969543
L 287.132656 53.390259
L 287.759652 61.165283
L 288.073149 63.304321
L 288.386647 63.727844
L 288.700145 62.427612
L 289.013643 59.606323
L 290.267634 45.537781
L 290.581132 44.488037
L 290.89463 45.24115
L 291.208128 47.609253
L 292.462119 61.506409
L 292.775617 62.859375
L 293.089115 62.641846
L 293.402612 60.893372
L 294.029608 54.219177
L 294.656604 47.589478
L 294.970102 45.638306
L 295.283599 45.162048
L 295.597097 46.335388
L 295.910595 48.924316
L 297.164586 62.05188
L 297.478084 62.861023
L 297.791582 62.078247
L 298.10508 59.840332
L 299.359071 46.747375
L 299.672569 45.31366
L 299.986067 45.465271
L 300.299565 47.180786
L 300.92656 53.952209
L 301.553556 60.738464
L 301.867054 62.495178
L 302.180552 62.70282
L 302.494049 61.358093
L 303.121045 55.1651
L 303.748041 48.326111
L 304.061538 46.094788
L 304.375036 45.22467
L 304.688534 45.972839
L 305.002032 48.212402
L 306.256023 61.511353
L 306.569521 62.712708
L 306.883019 62.338623
L 307.196517 60.471497
L 308.764006 45.630066
L 309.077504 45.366394
L 309.391001 46.689697
L 310.017997 52.966736
L 310.644993 60.000183
L 310.958491 62.091431
L 311.271988 62.712708
L 311.585486 61.758545
L 311.898984 59.416809
L 313.152975 46.632019
L 313.466473 45.394409
L 313.779971 45.70752
L 314.093469 47.582886
L 314.720464 54.390564
L 315.34746 60.896667
L 315.660958 62.467163
L 315.974456 62.495178
L 316.287954 60.995544
L 316.914949 54.716858
L 317.541945 48.113525
L 317.855443 46.043701
L 318.16894 45.359802
L 318.482438 46.282654
L 318.795936 48.639221
L 320.049927 61.611877
L 320.363425 62.612183
L 320.676923 62.056824
L 320.990421 60.064453
L 322.244412 47.299438
L 322.55791 45.847595
L 322.871408 45.880554
L 323.184906 47.380188
L 323.811901 53.447937
L 324.438897 59.690369
L 324.752395 61.453674
L 325.065893 61.878845
L 325.37939 60.891724
L 325.692888 58.68512
L 326.94688 47.254944
L 327.260377 46.256287
L 327.573875 46.651794
L 327.887373 48.385437
L 328.514369 54.50592
L 329.141364 60.280334
L 329.454862 61.643188
L 329.76836 61.623413
L 330.081858 60.225952
L 330.708853 54.53064
L 331.335849 48.611206
L 331.649347 46.811646
L 331.962845 46.274414
L 332.276343 47.124756
L 332.58984 49.237427
L 333.843832 60.838989
L 334.157329 61.750305
L 334.470827 61.269104
L 334.784325 59.477783
L 336.038316 47.937195
L 336.351814 46.523254
L 336.665312 46.447449
L 336.97881 47.722961
L 337.605806 53.344116
L 338.232801 59.471191
L 338.546299 61.247681
L 338.859797 61.704163
L 339.173295 60.771423
L 339.486792 58.624146
L 340.740784 47.367004
L 341.054282 46.388123
L 341.367779 46.755615
L 341.681277 48.448059
L 342.308273 54.448242
L 342.935269 60.153442
L 343.248766 61.517944
L 343.562264 61.508057
L 343.875762 60.146851
L 344.502758 54.560303
L 345.129753 48.766113
L 345.443251 46.997864
L 345.756749 54.950867
L 346.070247 50.643127
L 346.383745 66.890259
L 346.697242 39.292053
L 347.01074 49.899902
L 347.324238 54.728394
L 347.637736 75.693604
L 348.264731 34.107605
L 348.891727 75.912781
L 349.205225 45.025269
L 349.832221 54.868469
L 350.145718 59.621155
L 350.459216 37.652344
L 351.086212 52.704712
L 351.39971 57.292603
L 351.713208 44.235901
L 352.340203 63.162598
L 352.653701 61.882141
L 352.967199 52.134521
L 353.280697 54.814087
L 353.594194 60.600037
L 353.907692 55.067871
L 354.22119 43.759644
L 354.848186 53.233704
L 355.161684 47.381836
L 355.475181 44.918152
L 356.102177 58.807068
L 356.415675 55.22937
L 356.729173 54.726746
L 357.042671 61.839294
L 357.356168 64.037659
L 357.669666 58.080322
L 357.983164 54.392212
L 358.296662 55.1651
L 358.61016 55.203003
L 358.923657 48.098694
L 359.237155 45.95636
L 359.550653 48.957275
L 359.864151 50.453613
L 360.177649 48.716675
L 360.491147 50.941406
L 360.804644 56.363159
L 361.118142 58.704895
L 361.43164 58.91748
L 361.745138 59.720032
L 362.058636 61.335022
L 362.372134 59.228943
L 362.685631 55.55896
L 363.626125 49.209412
L 363.939623 46.763855
L 364.25312 47.292847
L 365.507112 55.933044
L 365.82061 59.278381
L 366.134107 60.397339
L 366.761103 60.049622
L 367.074601 58.645569
L 367.701597 52.467407
L 368.328592 48.767761
L 368.64209 47.269775
L 368.955588 47.271423
L 369.582583 51.651672
L 370.836575 60.763184
L 371.150073 60.445129
L 371.46357 59.314636
L 371.777068 57.501892
L 372.717562 49.458252
L 373.03106 48.013
L 373.344557 47.429626
L 373.658055 47.790527
L 373.971553 49.557129
L 375.225544 59.757935
L 375.539042 60.802734
L 375.85254 60.397339
L 376.166038 58.863098
L 376.793033 53.94397
L 377.420029 48.835327
L 377.733527 47.617493
L 378.047025 47.472473
L 378.360522 48.36731
L 378.67402 50.330017
L 379.614514 58.46759
L 379.928012 60.141907
L 380.241509 60.743408
L 380.555007 60.09906
L 380.868505 58.259949
L 382.122496 48.378845
L 382.435994 47.38678
L 382.749492 47.614197
L 383.06299 48.942444
L 383.689985 53.993408
L 384.316981 59.115234
L 384.630479 60.446777
L 384.943977 60.628052
L 385.257475 59.604675
L 385.88447 54.888245
L 386.511466 49.70874
L 386.824964 48.10199
L 387.138462 47.543335
L 387.451959 48.167908
L 387.765457 49.85376
L 389.019448 59.228943
L 389.332946 60.09082
L 389.646444 59.866699
L 389.959942 58.619202
L 390.586938 54.014832
L 391.213933 49.506042
L 391.527431 48.255249
L 391.840929 48.011353
L 392.154427 48.840271
L 392.467925 50.608521
L 393.721916 59.510742
L 394.035414 60.074341
L 394.348911 59.537109
L 394.662409 58.006165
L 395.916401 49.041321
L 396.229898 48.090454
L 396.543396 48.182739
L 396.856894 49.319824
L 397.48389 53.825317
L 398.110885 58.510437
L 398.424383 59.774414
L 398.737881 59.998535
L 399.051379 59.131714
L 399.678374 54.968994
L 400.30537 50.226196
L 400.618868 48.665588
L 400.932366 48.034424
L 401.245864 48.454651
L 401.559361 49.881775
L 402.813353 58.985046
L 403.126851 59.930969
L 403.440348 59.809021
L 403.753846 58.632385
L 404.380842 54.169739
L 405.007837 49.679077
L 405.321335 48.377197
L 405.634833 48.077271
L 405.948331 48.832031
L 406.261829 50.531067
L 407.51582 59.373962
L 407.829318 59.990295
L 408.142816 59.518982
L 408.456313 58.058899
L 409.710305 49.197876
L 410.023803 48.199219
L 410.3373 48.237122
L 410.650798 49.303345
L 411.277794 53.677002
L 411.90479 58.334106
L 412.218287 59.64917
L 412.531785 59.927673
L 412.845283 59.128418
L 413.472279 55.090942
L 414.099274 50.384399
L 414.412772 48.805664
L 414.72627 48.125061
L 415.039768 48.482666
L 415.353266 49.847168
L 416.920755 59.827148
L 417.234253 59.766174
L 417.54775 58.663696
L 418.174746 54.318054
L 418.801742 49.863647
L 419.115239 48.611206
L 419.428737 48.324463
L 419.742235 49.06604
L 420.369231 52.867859
L 420.996226 57.353577
L 421.309724 58.835083
L 421.623222 59.429993
L 421.93672 59.05426
L 422.250218 57.775452
L 423.504209 49.749939
L 423.817707 48.805664
L 424.131205 48.767761
L 424.444702 49.674133
L 425.071698 53.546814
L 425.698694 57.795227
L 426.012192 59.037781
L 426.325689 59.364075
L 426.639187 58.713135
L 426.952685 57.218445
L 428.206676 49.398926
L 428.520174 48.715027
L 428.833672 48.965515
L 429.14717 50.128967
L 429.774165 54.234009
L 430.401161 58.228638
L 430.714659 59.209167
L 431.028157 59.238831
L 431.341655 58.327515
L 431.96865 54.481201
L 432.595646 50.386047
L 432.909144 49.118774
L 433.222642 48.723267
L 433.536139 49.252258
L 433.849637 50.641479
L 435.103628 58.594482
L 435.417126 59.301453
L 435.730624 59.032837
L 436.044122 57.875977
L 437.611611 48.927612
L 437.925109 48.80896
L 438.238607 49.609863
L 438.865602 53.324341
L 439.492598 57.569458
L 439.806096 58.882874
L 440.119594 59.303101
L 440.433091 58.74939
L 440.746589 57.350281
L 442.000581 49.583496
L 442.314078 48.820496
L 442.627576 48.973755
L 442.941074 50.03009
L 443.56807 54.014832
L 444.195065 58.030884
L 444.508563 59.088867
L 444.822061 59.20752
L 445.135559 58.388489
L 445.762554 54.695435
L 446.38955 50.603577
L 446.703048 49.285217
L 447.016546 48.789185
L 447.330044 49.224243
L 447.643541 50.514587
L 448.897533 58.414856
L 449.21103 59.200928
L 449.524528 59.031189
L 449.838026 57.964966
L 450.465022 54.032959
L 451.092017 50.153687
L 451.405515 49.062744
L 451.719013 48.848511
L 452.032511 49.553833
L 452.346009 51.055115
L 453.6 58.634033
L 453.6 58.634033
&#34; style=&#34;fill:none;stroke:#1a0dcc;stroke-linecap:square;stroke-width:1.5;&#34;/&gt;
   &lt;/g&gt;
  &lt;/g&gt;
 &lt;/g&gt;
 &lt;defs&gt;
  &lt;clipPath id=&#34;p629da2a526&#34;&gt;
   &lt;rect height=&#34;108&#34; width=&#34;475.2&#34; x=&#34;0&#34; y=&#34;0&#34;/&gt;
  &lt;/clipPath&gt;
 &lt;/defs&gt;
&lt;/svg&gt;
&lt;/span&gt;


&lt;/blockquote&gt;

&lt;p&gt;This sounds dreadful, but we can subtract it from the original signal to produce&lt;/p&gt;

&lt;blockquote&gt;

&lt;span class=&#34;svg&#34;&gt;&lt;svg height=&#34;108pt&#34; version=&#34;1.1&#34; viewBox=&#34;0 0 475.2 108&#34; width=&#34;475.2pt&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; xmlns:xlink=&#34;http://www.w3.org/1999/xlink&#34;&gt;

 &lt;g id=&#34;figure_1&#34;&gt;
  &lt;g id=&#34;patch_1&#34;&gt;
   &lt;path d=&#34;M 0 108
L 475.2 108
L 475.2 0
L 0 0
z
&#34; style=&#34;fill:none;&#34;/&gt;
  &lt;/g&gt;
  &lt;g id=&#34;axes_1&#34;&gt;
   &lt;g id=&#34;line2d_1&#34;&gt;
    &lt;path clip-path=&#34;url(#p0c8c92a352)&#34; d=&#34;M 21.6 53.980225
L 21.913498 46.877563
L 22.226996 59.535461
L 22.540493 61.38446
L 22.853991 47.698242
L 23.167489 44.848938
L 23.480987 56.53949
L 23.794485 60.857117
L 24.107983 56.165405
L 24.42148 57.406311
L 24.734978 60.984009
L 25.048476 57.806763
L 25.361974 48.156372
L 25.675472 50.494812
L 25.98897 49.262146
L 26.302467 46.131042
L 26.615965 45.381226
L 26.929463 54.214233
L 27.242961 59.462952
L 27.556459 57.940247
L 27.869956 57.650208
L 28.183454 60.352844
L 28.496952 59.462952
L 28.81045 54.611389
L 29.123948 52.976624
L 29.437446 54.232361
L 30.064441 49.346191
L 30.377939 48.639221
L 31.004935 53.36554
L 31.318433 54.00824
L 31.63193 55.962708
L 31.945428 57.035522
L 32.258926 57.220093
L 32.572424 56.112671
L 33.199419 55.142029
L 33.826415 52.600891
L 34.139913 51.908752
L 34.453411 51.791748
L 34.766909 51.837891
L 35.080406 52.447632
L 35.707402 54.805847
L 36.0209 55.22113
L 36.647896 55.524353
L 36.961393 55.435364
L 37.588389 54.163147
L 37.901887 53.817078
L 38.528882 52.796997
L 38.84238 52.628906
L 39.155878 52.958496
L 40.096372 54.365845
L 40.409869 54.711914
L 40.723367 54.819031
L 41.350363 54.606445
L 41.977358 54.079102
L 42.604354 53.583069
L 43.23135 53.370483
L 43.544848 53.472656
L 44.798839 54.364197
L 45.425835 54.425171
L 46.05283 54.182922
L 47.306821 53.645691
L 47.933817 53.759399
L 48.874311 54.146667
L 49.501306 54.214233
L 50.4418 54.07251
L 51.695791 53.831909
L 52.636284 53.950562
L 53.576778 54.112061
L 54.517271 54.075806
L 56.084761 53.902771
L 59.533237 53.993408
L 61.100726 53.975281
L 63.29521 54.013184
L 66.116691 54.011536
L 129.756749 54.034607
L 130.070247 43.927734
L 130.383745 60.216064
L 130.697242 50.354736
L 131.01074 46.71936
L 131.324238 59.291565
L 131.637736 64.073914
L 131.951234 53.962097
L 132.264731 59.27179
L 132.578229 60.09082
L 132.891727 58.810364
L 133.205225 51.106201
L 133.518723 46.996216
L 133.832221 51.707703
L 134.145718 51.294067
L 134.459216 50.516235
L 134.772714 53.16449
L 135.086212 56.80481
L 135.39971 57.122864
L 135.713208 55.664429
L 136.026705 55.881958
L 136.340203 58.432983
L 136.653701 56.867432
L 136.967199 52.866211
L 137.594194 53.973633
L 137.907692 51.86261
L 138.22119 51.233093
L 138.534688 51.295715
L 138.848186 52.983215
L 139.161684 53.299622
L 139.475181 53.914307
L 139.788679 55.137085
L 140.102177 55.867126
L 140.729173 55.140381
L 141.042671 54.949219
L 141.356168 54.472961
L 141.983164 53.129883
L 142.61016 52.792053
L 142.923657 52.77063
L 143.237155 53.215576
L 143.864151 54.364197
L 144.804644 54.894836
L 145.118142 54.756409
L 146.058636 53.932434
L 146.999129 53.358948
L 147.626125 53.625916
L 148.880116 54.423523
L 149.507112 54.380676
L 150.134107 54.082397
L 151.074601 53.685242
L 151.701597 53.693481
L 152.955588 54.173035
L 153.582583 54.229065
L 154.836575 53.965393
L 155.777068 53.828613
L 157.03106 54.041199
L 158.285051 54.097229
L 160.479536 53.92749
L 162.987518 54.028015
L 165.182003 53.980225
L 167.689985 54.00824
L 169.88447 53.998352
L 175.213933 54.011536
L 181.170392 53.995056
L 185.245864 54.003296
L 190.575327 54.001648
L 197.472279 54
L 207.817707 53.998352
L 237.913498 54.023071
L 238.226996 61.882141
L 238.853991 45.091187
L 239.480987 61.549255
L 240.107983 45.758606
L 240.42148 53.970337
L 240.734978 57.533203
L 241.048476 55.522705
L 241.361974 49.570312
L 241.98897 57.225037
L 242.302467 56.633423
L 242.615965 52.261414
L 242.929463 57.287659
L 243.242961 56.526306
L 243.869956 51.007324
L 244.496952 54.369141
L 245.123948 51.239685
L 245.437446 53.957153
L 245.750943 53.851685
L 246.064441 52.704712
L 246.377939 53.845093
L 246.691437 55.506226
L 247.004935 55.410645
L 247.318433 54.91626
L 247.63193 54.725098
L 247.945428 54.847046
L 248.258926 54.397156
L 248.572424 53.667114
L 248.885922 53.439697
L 249.199419 53.457825
L 249.826415 53.057373
L 250.139913 53.316101
L 250.453411 53.904419
L 250.766909 54.186218
L 251.080406 54.225769
L 251.707402 54.733337
L 253.588389 53.616028
L 253.901887 53.563293
L 254.84238 53.772583
L 255.469376 54.159851
L 256.723367 54.263672
L 257.977358 53.876404
L 258.604354 53.787415
L 259.858345 54.021423
L 260.798839 54.130188
L 261.739332 54.047791
L 262.993324 53.907715
L 264.247315 53.988464
L 265.814804 54.05603
L 270.203774 54.028015
L 278.354717 54.003296
L 281.489695 53.996704
L 291.521626 53.993408
L 294.656604 54.001648
L 305.002032 53.996704
L 309.077504 54.001648
L 319.109434 54.004944
L 345.756749 54.034607
L 346.070247 52.932129
L 346.383745 58.077026
L 346.697242 48.9375
L 347.01074 52.500366
L 347.324238 54.245544
L 347.637736 62.933533
L 348.264731 46.608948
L 348.891727 61.40918
L 349.205225 51.135864
L 349.518723 53.044189
L 350.145718 55.529297
L 350.459216 49.77301
L 351.086212 53.698425
L 351.39971 54.721802
L 351.713208 51.959839
L 352.026705 54.25708
L 352.340203 55.723755
L 352.653701 55.415588
L 352.967199 53.673706
L 353.280697 54.138428
L 353.594194 55.006897
L 353.907692 54.153259
L 354.22119 52.587708
L 354.848186 53.902771
L 355.161684 53.222168
L 355.475181 52.983215
L 356.102177 54.491089
L 356.415675 54.113708
L 356.729173 54.074158
L 357.042671 54.687195
L 357.356168 54.830566
L 357.669666 54.326294
L 357.983164 54.034607
L 358.61016 54.075806
L 358.923657 53.620972
L 359.237155 53.503967
L 359.864151 53.80719
L 360.177649 53.714905
L 360.491147 53.843445
L 360.804644 54.108765
L 361.43164 54.212585
L 362.372134 54.19281
L 362.999129 53.986816
L 364.25312 53.810486
L 366.447605 54.118652
L 367.701597 53.981873
L 368.955588 53.904419
L 371.46357 54.049438
L 374.285051 53.986816
L 376.793033 54.004944
L 379.301016 54.00824
L 385.570972 54.006592
L 390.900435 53.993408
L 395.289405 53.998352
L 402.186357 54.006592
L 406.575327 53.996704
L 410.023803 54.003296
L 415.666763 53.995056
L 437.611611 54.001648
L 444.508563 53.995056
L 448.897533 54
L 453.6 54.001648
L 453.6 54.001648
&#34; style=&#34;fill:none;stroke:#cc0d1a;stroke-linecap:square;stroke-width:1.5;&#34;/&gt;
   &lt;/g&gt;
  &lt;/g&gt;
 &lt;/g&gt;
 &lt;defs&gt;
  &lt;clipPath id=&#34;p0c8c92a352&#34;&gt;
   &lt;rect height=&#34;108&#34; width=&#34;475.2&#34; x=&#34;0&#34; y=&#34;0&#34;/&gt;
  &lt;/clipPath&gt;
 &lt;/defs&gt;
&lt;/svg&gt;
&lt;/span&gt;


&lt;/blockquote&gt;

&lt;p&gt;which gives the peaks, and we can do whatever we want with them. But the isolation isn&amp;rsquo;t perfect. The decaying tone causes the compressor to dampen the signal more when the tone is loud, and some of the tone ends up in the peaks signal.  What we care about is that they sum exactly to the original signal, and we can now process them independently.&lt;/p&gt;

&lt;h2 id=&#34;saturators&#34;&gt;Saturators&lt;/h2&gt;

&lt;p&gt;Applying a saturator to the difference signal of a saturator &lt;em&gt;reduces&lt;/em&gt; the amount of distortion. The simplest saturator is the hard-clip 
&lt;span class=&#34;svgi&#34;&gt;&lt;svg height=&#34;18pt&#34; version=&#34;1.1&#34; viewBox=&#34;0 0 28.8 18&#34; width=&#34;28.8pt&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; xmlns:xlink=&#34;http://www.w3.org/1999/xlink&#34;&gt;

 &lt;g id=&#34;figure_1&#34;&gt;
  &lt;g id=&#34;patch_1&#34;&gt;
   &lt;path d=&#34;M 0 18
L 28.8 18
L 28.8 0
L 0 0
z
&#34; style=&#34;fill:none;&#34;/&gt;
  &lt;/g&gt;
  &lt;g id=&#34;axes_1&#34;&gt;
   &lt;g id=&#34;line2d_1&#34;&gt;
    &lt;path clip-path=&#34;url(#p7eb5527340)&#34; d=&#34;M 1.309091 11.97
L 1.724675 11.97
L 2.14026 11.97
L 2.555844 11.97
L 2.971429 11.97
L 3.387013 11.97
L 3.802597 11.97
L 4.218182 11.97
L 4.633766 11.97
L 5.049351 11.97
L 5.464935 11.97
L 5.880519 11.97
L 6.296104 11.97
L 6.711688 11.97
L 7.127273 11.97
L 7.542857 11.97
L 7.958442 11.97
L 8.374026 11.97
L 8.78961 11.97
L 9.205195 11.97
L 9.620779 11.97
L 10.036364 11.97
L 10.451948 11.714286
L 10.867532 11.428571
L 11.283117 11.142857
L 11.698701 10.857143
L 12.114286 10.571429
L 12.52987 10.285714
L 12.945455 10
L 13.361039 9.714286
L 13.776623 9.428571
L 14.192208 9.142857
L 14.607792 8.857143
L 15.023377 8.571429
L 15.438961 8.285714
L 15.854545 8
L 16.27013 7.714286
L 16.685714 7.428571
L 17.101299 7.142857
L 17.516883 6.857143
L 17.932468 6.571429
L 18.348052 6.285714
L 18.763636 6.03
L 19.179221 6.03
L 19.594805 6.03
L 20.01039 6.03
L 20.425974 6.03
L 20.841558 6.03
L 21.257143 6.03
L 21.672727 6.03
L 22.088312 6.03
L 22.503896 6.03
L 22.919481 6.03
L 23.335065 6.03
L 23.750649 6.03
L 24.166234 6.03
L 24.581818 6.03
L 24.997403 6.03
L 25.412987 6.03
L 25.828571 6.03
L 26.244156 6.03
L 26.65974 6.03
L 27.075325 6.03
L 27.490909 6.03
&#34; style=&#34;fill:none;stroke:#1a0dcc;stroke-linecap:square;stroke-width:1.5;&#34;/&gt;
   &lt;/g&gt;
  &lt;/g&gt;
 &lt;/g&gt;
 &lt;defs&gt;
  &lt;clipPath id=&#34;p7eb5527340&#34;&gt;
   &lt;rect height=&#34;18&#34; width=&#34;28.8&#34; x=&#34;0&#34; y=&#34;0&#34;/&gt;
  &lt;/clipPath&gt;
 &lt;/defs&gt;
&lt;/svg&gt;
&lt;/span&gt;

, and the difference signal of this is also a saturator, 
&lt;span class=&#34;svgi&#34;&gt;&lt;svg height=&#34;18pt&#34; version=&#34;1.1&#34; viewBox=&#34;0 0 28.8 18&#34; width=&#34;28.8pt&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; xmlns:xlink=&#34;http://www.w3.org/1999/xlink&#34;&gt;

 &lt;g id=&#34;figure_1&#34;&gt;
  &lt;g id=&#34;patch_1&#34;&gt;
   &lt;path d=&#34;M 0 18
L 28.8 18
L 28.8 0
L 0 0
z
&#34; style=&#34;fill:none;&#34;/&gt;
  &lt;/g&gt;
  &lt;g id=&#34;axes_1&#34;&gt;
   &lt;g id=&#34;line2d_1&#34;&gt;
    &lt;path clip-path=&#34;url(#p411deb80e6)&#34; d=&#34;M 1.309091 2.97
L 1.724675 3.255714
L 2.14026 3.541429
L 2.555844 3.827143
L 2.971429 4.112857
L 3.387013 4.398571
L 3.802597 4.684286
L 4.218182 4.97
L 4.633766 5.255714
L 5.049351 5.541429
L 5.464935 5.827143
L 5.880519 6.112857
L 6.296104 6.398571
L 6.711688 6.684286
L 7.127273 6.97
L 7.542857 7.255714
L 7.958442 7.541429
L 8.374026 7.827143
L 8.78961 8.112857
L 9.205195 8.398571
L 9.620779 8.684286
L 10.036364 8.97
L 10.451948 9
L 10.867532 9
L 11.283117 9
L 11.698701 9
L 12.114286 9
L 12.52987 9
L 12.945455 9
L 13.361039 9
L 13.776623 9
L 14.192208 9
L 14.607792 9
L 15.023377 9
L 15.438961 9
L 15.854545 9
L 16.27013 9
L 16.685714 9
L 17.101299 9
L 17.516883 9
L 17.932468 9
L 18.348052 9
L 18.763636 9.03
L 19.179221 9.315714
L 19.594805 9.601429
L 20.01039 9.887143
L 20.425974 10.172857
L 20.841558 10.458571
L 21.257143 10.744286
L 21.672727 11.03
L 22.088312 11.315714
L 22.503896 11.601429
L 22.919481 11.887143
L 23.335065 12.172857
L 23.750649 12.458571
L 24.166234 12.744286
L 24.581818 13.03
L 24.997403 13.315714
L 25.412987 13.601429
L 25.828571 13.887143
L 26.244156 14.172857
L 26.65974 14.458571
L 27.075325 14.744286
L 27.490909 15.03
&#34; style=&#34;fill:none;stroke:#1a0dcc;stroke-linecap:square;stroke-width:1.5;&#34;/&gt;
   &lt;/g&gt;
  &lt;/g&gt;
 &lt;/g&gt;
 &lt;defs&gt;
  &lt;clipPath id=&#34;p411deb80e6&#34;&gt;
   &lt;rect height=&#34;18&#34; width=&#34;28.8&#34; x=&#34;0&#34; y=&#34;0&#34;/&gt;
  &lt;/clipPath&gt;
 &lt;/defs&gt;
&lt;/svg&gt;
&lt;/span&gt;

. If we hard-clip this curve, we get 
&lt;span class=&#34;svgi&#34;&gt;&lt;svg height=&#34;18pt&#34; version=&#34;1.1&#34; viewBox=&#34;0 0 28.8 18&#34; width=&#34;28.8pt&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; xmlns:xlink=&#34;http://www.w3.org/1999/xlink&#34;&gt;

 &lt;g id=&#34;figure_1&#34;&gt;
  &lt;g id=&#34;patch_1&#34;&gt;
   &lt;path d=&#34;M 0 18
L 28.8 18
L 28.8 0
L 0 0
z
&#34; style=&#34;fill:none;&#34;/&gt;
  &lt;/g&gt;
  &lt;g id=&#34;axes_1&#34;&gt;
   &lt;g id=&#34;line2d_1&#34;&gt;
    &lt;path clip-path=&#34;url(#pabcc87849c)&#34; d=&#34;M 1.309091 6.03
L 1.724675 6.03
L 2.14026 6.03
L 2.555844 6.03
L 2.971429 6.03
L 3.387013 6.03
L 3.802597 6.03
L 4.218182 6.03
L 4.633766 6.03
L 5.049351 6.03
L 5.464935 6.03
L 5.880519 6.112857
L 6.296104 6.398571
L 6.711688 6.684286
L 7.127273 6.97
L 7.542857 7.255714
L 7.958442 7.541429
L 8.374026 7.827143
L 8.78961 8.112857
L 9.205195 8.398571
L 9.620779 8.684286
L 10.036364 8.97
L 10.451948 9
L 10.867532 9
L 11.283117 9
L 11.698701 9
L 12.114286 9
L 12.52987 9
L 12.945455 9
L 13.361039 9
L 13.776623 9
L 14.192208 9
L 14.607792 9
L 15.023377 9
L 15.438961 9
L 15.854545 9
L 16.27013 9
L 16.685714 9
L 17.101299 9
L 17.516883 9
L 17.932468 9
L 18.348052 9
L 18.763636 9.03
L 19.179221 9.315714
L 19.594805 9.601429
L 20.01039 9.887143
L 20.425974 10.172857
L 20.841558 10.458571
L 21.257143 10.744286
L 21.672727 11.03
L 22.088312 11.315714
L 22.503896 11.601429
L 22.919481 11.887143
L 23.335065 11.97
L 23.750649 11.97
L 24.166234 11.97
L 24.581818 11.97
L 24.997403 11.97
L 25.412987 11.97
L 25.828571 11.97
L 26.244156 11.97
L 26.65974 11.97
L 27.075325 11.97
L 27.490909 11.97
&#34; style=&#34;fill:none;stroke:#1a0dcc;stroke-linecap:square;stroke-width:1.5;&#34;/&gt;
   &lt;/g&gt;
  &lt;/g&gt;
 &lt;/g&gt;
 &lt;defs&gt;
  &lt;clipPath id=&#34;pabcc87849c&#34;&gt;
   &lt;rect height=&#34;18&#34; width=&#34;28.8&#34; x=&#34;0&#34; y=&#34;0&#34;/&gt;
  &lt;/clipPath&gt;
 &lt;/defs&gt;
&lt;/svg&gt;
&lt;/span&gt;

, and adding this to the original signal 
&lt;span class=&#34;svgi&#34;&gt;&lt;svg height=&#34;18pt&#34; version=&#34;1.1&#34; viewBox=&#34;0 0 28.8 18&#34; width=&#34;28.8pt&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; xmlns:xlink=&#34;http://www.w3.org/1999/xlink&#34;&gt;

 &lt;g id=&#34;figure_1&#34;&gt;
  &lt;g id=&#34;patch_1&#34;&gt;
   &lt;path d=&#34;M 0 18
L 28.8 18
L 28.8 0
L 0 0
z
&#34; style=&#34;fill:none;&#34;/&gt;
  &lt;/g&gt;
  &lt;g id=&#34;axes_1&#34;&gt;
   &lt;g id=&#34;line2d_1&#34;&gt;
    &lt;path clip-path=&#34;url(#pecdcb50537)&#34; d=&#34;M 1.309091 18
L 1.724675 17.714286
L 2.14026 17.428571
L 2.555844 17.142857
L 2.971429 16.857143
L 3.387013 16.571429
L 3.802597 16.285714
L 4.218182 16
L 4.633766 15.714286
L 5.049351 15.428571
L 5.464935 15.142857
L 5.880519 14.857143
L 6.296104 14.571429
L 6.711688 14.285714
L 7.127273 14
L 7.542857 13.714286
L 7.958442 13.428571
L 8.374026 13.142857
L 8.78961 12.857143
L 9.205195 12.571429
L 9.620779 12.285714
L 10.036364 12
L 10.451948 11.714286
L 10.867532 11.428571
L 11.283117 11.142857
L 11.698701 10.857143
L 12.114286 10.571429
L 12.52987 10.285714
L 12.945455 10
L 13.361039 9.714286
L 13.776623 9.428571
L 14.192208 9.142857
L 14.607792 8.857143
L 15.023377 8.571429
L 15.438961 8.285714
L 15.854545 8
L 16.27013 7.714286
L 16.685714 7.428571
L 17.101299 7.142857
L 17.516883 6.857143
L 17.932468 6.571429
L 18.348052 6.285714
L 18.763636 6
L 19.179221 5.714286
L 19.594805 5.428571
L 20.01039 5.142857
L 20.425974 4.857143
L 20.841558 4.571429
L 21.257143 4.285714
L 21.672727 4
L 22.088312 3.714286
L 22.503896 3.428571
L 22.919481 3.142857
L 23.335065 2.857143
L 23.750649 2.571429
L 24.166234 2.285714
L 24.581818 2
L 24.997403 1.714286
L 25.412987 1.428571
L 25.828571 1.142857
L 26.244156 0.857143
L 26.65974 0.571429
L 27.075325 0.285714
L 27.490909 0
&#34; style=&#34;fill:none;stroke:#1a0dcc;stroke-linecap:square;stroke-width:1.5;&#34;/&gt;
   &lt;/g&gt;
  &lt;/g&gt;
 &lt;/g&gt;
 &lt;defs&gt;
  &lt;clipPath id=&#34;pecdcb50537&#34;&gt;
   &lt;rect height=&#34;18&#34; width=&#34;28.8&#34; x=&#34;0&#34; y=&#34;0&#34;/&gt;
  &lt;/clipPath&gt;
 &lt;/defs&gt;
&lt;/svg&gt;
&lt;/span&gt;

 produces the saturator curve 
&lt;span class=&#34;svgi&#34;&gt;&lt;svg height=&#34;18pt&#34; version=&#34;1.1&#34; viewBox=&#34;0 0 28.8 18&#34; width=&#34;28.8pt&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; xmlns:xlink=&#34;http://www.w3.org/1999/xlink&#34;&gt;

 &lt;g id=&#34;figure_1&#34;&gt;
  &lt;g id=&#34;patch_1&#34;&gt;
   &lt;path d=&#34;M 0 18
L 28.8 18
L 28.8 0
L 0 0
z
&#34; style=&#34;fill:none;&#34;/&gt;
  &lt;/g&gt;
  &lt;g id=&#34;axes_1&#34;&gt;
   &lt;g id=&#34;line2d_1&#34;&gt;
    &lt;path clip-path=&#34;url(#pac73bfb031)&#34; d=&#34;M 1.309091 15.03
L 1.724675 14.744286
L 2.14026 14.458571
L 2.555844 14.172857
L 2.971429 13.887143
L 3.387013 13.601429
L 3.802597 13.315714
L 4.218182 13.03
L 4.633766 12.744286
L 5.049351 12.458571
L 5.464935 12.172857
L 5.880519 11.97
L 6.296104 11.97
L 6.711688 11.97
L 7.127273 11.97
L 7.542857 11.97
L 7.958442 11.97
L 8.374026 11.97
L 8.78961 11.97
L 9.205195 11.97
L 9.620779 11.97
L 10.036364 11.97
L 10.451948 11.714286
L 10.867532 11.428571
L 11.283117 11.142857
L 11.698701 10.857143
L 12.114286 10.571429
L 12.52987 10.285714
L 12.945455 10
L 13.361039 9.714286
L 13.776623 9.428571
L 14.192208 9.142857
L 14.607792 8.857143
L 15.023377 8.571429
L 15.438961 8.285714
L 15.854545 8
L 16.27013 7.714286
L 16.685714 7.428571
L 17.101299 7.142857
L 17.516883 6.857143
L 17.932468 6.571429
L 18.348052 6.285714
L 18.763636 6.03
L 19.179221 6.03
L 19.594805 6.03
L 20.01039 6.03
L 20.425974 6.03
L 20.841558 6.03
L 21.257143 6.03
L 21.672727 6.03
L 22.088312 6.03
L 22.503896 6.03
L 22.919481 6.03
L 23.335065 5.827143
L 23.750649 5.541429
L 24.166234 5.255714
L 24.581818 4.97
L 24.997403 4.684286
L 25.412987 4.398571
L 25.828571 4.112857
L 26.244156 3.827143
L 26.65974 3.541429
L 27.075325 3.255714
L 27.490909 2.97
&#34; style=&#34;fill:none;stroke:#1a0dcc;stroke-linecap:square;stroke-width:1.5;&#34;/&gt;
   &lt;/g&gt;
  &lt;/g&gt;
 &lt;/g&gt;
 &lt;defs&gt;
  &lt;clipPath id=&#34;pac73bfb031&#34;&gt;
   &lt;rect height=&#34;18&#34; width=&#34;28.8&#34; x=&#34;0&#34; y=&#34;0&#34;/&gt;
  &lt;/clipPath&gt;
 &lt;/defs&gt;
&lt;/svg&gt;
&lt;/span&gt;

. This saturator doesn&amp;rsquo;t clip very quiet or very loud signal values, only those somewhere inbetween.&lt;/p&gt;

&lt;p&gt;One of the nice things about this is that good saturators have good anti-aliasing, and so will any curves you make this way.&lt;/p&gt;

&lt;p&gt;Less esoterically, think of saturation as adding harmonic content. Taking the difference isolates the added harmonics, and you can apply EQ to them.&lt;/p&gt;

&lt;p&gt;Another option is to EQ before saturating, take the difference between the EQ&amp;rsquo;d and saturated signals, then add that back to the original signal. Now you have a saturator that responds differently to certain frequencies. Mixing linear and non-linear effects this way will mess with any intuition you have for them&amp;ndash;don&amp;rsquo;t think you&amp;rsquo;re being scientific when you do this.&lt;/p&gt;

&lt;h3 id=&#34;bit-depth-reduction&#34;&gt;Bit-depth Reduction&lt;/h3&gt;

&lt;p&gt;You can think of bit-depth reduction as an extreme saturation curve, 
&lt;span class=&#34;svgi&#34;&gt;&lt;svg height=&#34;18pt&#34; version=&#34;1.1&#34; viewBox=&#34;0 0 28.8 18&#34; width=&#34;28.8pt&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; xmlns:xlink=&#34;http://www.w3.org/1999/xlink&#34;&gt;

 &lt;g id=&#34;figure_1&#34;&gt;
  &lt;g id=&#34;patch_1&#34;&gt;
   &lt;path d=&#34;M 0 18
L 28.8 18
L 28.8 0
L 0 0
z
&#34; style=&#34;fill:none;&#34;/&gt;
  &lt;/g&gt;
  &lt;g id=&#34;axes_1&#34;&gt;
   &lt;g id=&#34;line2d_1&#34;&gt;
    &lt;path clip-path=&#34;url(#p97dbe01af5)&#34; d=&#34;M 1.309091 18
L 1.724675 18
L 2.14026 18
L 2.555844 18
L 2.971429 18
L 3.387013 18
L 3.802597 18
L 4.218182 18
L 4.633766 15.75
L 5.049351 15.75
L 5.464935 15.75
L 5.880519 15.75
L 6.296104 15.75
L 6.711688 15.75
L 7.127273 15.75
L 7.542857 15.75
L 7.958442 13.5
L 8.374026 13.5
L 8.78961 13.5
L 9.205195 13.5
L 9.620779 13.5
L 10.036364 13.5
L 10.451948 13.5
L 10.867532 13.5
L 11.283117 11.25
L 11.698701 11.25
L 12.114286 11.25
L 12.52987 11.25
L 12.945455 11.25
L 13.361039 11.25
L 13.776623 11.25
L 14.192208 11.25
L 14.607792 9
L 15.023377 9
L 15.438961 9
L 15.854545 9
L 16.27013 9
L 16.685714 9
L 17.101299 9
L 17.516883 9
L 17.932468 6.75
L 18.348052 6.75
L 18.763636 6.75
L 19.179221 6.75
L 19.594805 6.75
L 20.01039 6.75
L 20.425974 6.75
L 20.841558 6.75
L 21.257143 4.5
L 21.672727 4.5
L 22.088312 4.5
L 22.503896 4.5
L 22.919481 4.5
L 23.335065 4.5
L 23.750649 4.5
L 24.166234 4.5
L 24.581818 2.25
L 24.997403 2.25
L 25.412987 2.25
L 25.828571 2.25
L 26.244156 2.25
L 26.65974 2.25
L 27.075325 2.25
L 27.490909 0
&#34; style=&#34;fill:none;stroke:#1a0dcc;stroke-linecap:square;stroke-width:1.5;&#34;/&gt;
   &lt;/g&gt;
  &lt;/g&gt;
 &lt;/g&gt;
 &lt;defs&gt;
  &lt;clipPath id=&#34;p97dbe01af5&#34;&gt;
   &lt;rect height=&#34;18&#34; width=&#34;28.8&#34; x=&#34;0&#34; y=&#34;0&#34;/&gt;
  &lt;/clipPath&gt;
 &lt;/defs&gt;
&lt;/svg&gt;
&lt;/span&gt;

. This particular curve reduces a signal to 3 bits of dynamic range: &lt;code&gt;000&lt;/code&gt;, &lt;code&gt;001&lt;/code&gt;, &lt;code&gt;010&lt;/code&gt;, &lt;code&gt;011&lt;/code&gt;, &lt;code&gt;100&lt;/code&gt;, &lt;code&gt;101&lt;/code&gt;, &lt;code&gt;110&lt;/code&gt;, and &lt;code&gt;111&lt;/code&gt;. The entire dynamic range is mapped to these 8 values, so there are 8 steps. Its difference signal is 
&lt;span class=&#34;svgi&#34;&gt;&lt;svg height=&#34;18pt&#34; version=&#34;1.1&#34; viewBox=&#34;0 0 28.8 18&#34; width=&#34;28.8pt&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; xmlns:xlink=&#34;http://www.w3.org/1999/xlink&#34;&gt;

 &lt;g id=&#34;figure_1&#34;&gt;
  &lt;g id=&#34;patch_1&#34;&gt;
   &lt;path d=&#34;M 0 18
L 28.8 18
L 28.8 0
L 0 0
z
&#34; style=&#34;fill:none;&#34;/&gt;
  &lt;/g&gt;
  &lt;g id=&#34;axes_1&#34;&gt;
   &lt;g id=&#34;line2d_1&#34;&gt;
    &lt;path clip-path=&#34;url(#pe010576229)&#34; d=&#34;M 1.309091 9
L 1.724675 9.285714
L 2.14026 9.571429
L 2.555844 9.857143
L 2.971429 10.142857
L 3.387013 10.428571
L 3.802597 10.714286
L 4.218182 11
L 4.633766 9.035714
L 5.049351 9.321429
L 5.464935 9.607143
L 5.880519 9.892857
L 6.296104 10.178571
L 6.711688 10.464286
L 7.127273 10.75
L 7.542857 11.035714
L 7.958442 9.071429
L 8.374026 9.357143
L 8.78961 9.642857
L 9.205195 9.928571
L 9.620779 10.214286
L 10.036364 10.5
L 10.451948 10.785714
L 10.867532 11.071429
L 11.283117 9.107143
L 11.698701 9.392857
L 12.114286 9.678571
L 12.52987 9.964286
L 12.945455 10.25
L 13.361039 10.535714
L 13.776623 10.821429
L 14.192208 11.107143
L 14.607792 9.142857
L 15.023377 9.428571
L 15.438961 9.714286
L 15.854545 10
L 16.27013 10.285714
L 16.685714 10.571429
L 17.101299 10.857143
L 17.516883 11.142857
L 17.932468 9.178571
L 18.348052 9.464286
L 18.763636 9.75
L 19.179221 10.035714
L 19.594805 10.321429
L 20.01039 10.607143
L 20.425974 10.892857
L 20.841558 11.178571
L 21.257143 9.214286
L 21.672727 9.5
L 22.088312 9.785714
L 22.503896 10.071429
L 22.919481 10.357143
L 23.335065 10.642857
L 23.750649 10.928571
L 24.166234 11.214286
L 24.581818 9.25
L 24.997403 9.535714
L 25.412987 9.821429
L 25.828571 10.107143
L 26.244156 10.392857
L 26.65974 10.678571
L 27.075325 10.964286
L 27.490909 9
&#34; style=&#34;fill:none;stroke:#1a0dcc;stroke-linecap:square;stroke-width:1.5;&#34;/&gt;
   &lt;/g&gt;
  &lt;/g&gt;
 &lt;/g&gt;
 &lt;defs&gt;
  &lt;clipPath id=&#34;pe010576229&#34;&gt;
   &lt;rect height=&#34;18&#34; width=&#34;28.8&#34; x=&#34;0&#34; y=&#34;0&#34;/&gt;
  &lt;/clipPath&gt;
 &lt;/defs&gt;
&lt;/svg&gt;
&lt;/span&gt;

.&lt;/p&gt;

&lt;p&gt;There are two ways to interpret it. One is that it&amp;rsquo;s wraparound distortion (see the &lt;a href=&#34;https://docs.cycling74.com/max7/maxobject/pong~&#34;&gt;pong~&lt;/a&gt; object in Max/MSP). Another is that it&amp;rsquo;s giving you back the bits the other curve throws away. Either way, I like experimenting with this. I&amp;rsquo;m one of those unfortunate people who likes the sound of bit crushing, and you can use this to get a lot more variation (and dynamic range) out of it.&lt;/p&gt;

&lt;h3 id=&#34;doing-it&#34;&gt;Doing It&lt;/h3&gt;

&lt;p&gt;The best way of actually doing this took me a while to figure out. I use Ableton Live, which has audio effect racks. They are almost enough to do everything we want to do, but if you&amp;rsquo;re using a DAW that instead relies on complex routing, it might be too unwieldly to use in practice. I&amp;rsquo;ve settled on using two audio effect racks, one for the &lt;code&gt;a[n] + (b[n] - a[n])&lt;/code&gt; case, and another for the &lt;code&gt;b[n] + (a[n] - b[n])&lt;/code&gt; case, which I call positive and negative.&lt;/p&gt;

&lt;p&gt;The positive case is easiest, because &lt;code&gt;a[n]&lt;/code&gt; is the original dry signal, and we can duplicate it as needed by adding more chains to an audio effect rack.&lt;/p&gt;


&lt;div style=&#34;display: flex; justify-content: center;&#34; /&gt;
    &lt;img src=&#34;https://graemephi.github.io/posts/dumb-tricks-with-phase-inversion/AER1.png&#34;/&gt;
&lt;/div&gt;



&lt;p&gt;The outer A chain is empty. The inner -A chain contains a utility effect with both channels inverted. Then, you place any effect you want the difference signal of in the B chain, and can process the difference signal after the inner audio effect rack. The utility effects gain knob acts as a dry/wet mix; the effect is 100% wet at 0 dB.&lt;/p&gt;

&lt;p&gt;The negative case is more tricky. Implementing &lt;code&gt;b[n] + (a[n] - b[n])&lt;/code&gt; requires routing that effect racks can&amp;rsquo;t do. You could produce &lt;code&gt;b&lt;/code&gt; twice, but having to update the every parameter twice (or being limited to the effect rack&amp;rsquo;s macro controls) is a huge pain. Instead, I use the side chain from some of Ableton&amp;rsquo;s effects, which can capture audio before or after any effect rack. &lt;a href=&#34;posts/dumb-tricks-with-phase-inversion/AER2.png&#34;&gt;See here for an image&lt;/a&gt;, where I&amp;rsquo;ve used the compressor&amp;rsquo;s side chain, set to audition, to tap audio from the B chain before inverting it. To use this, we put an effect in the B chain, and everything after the inner effect rack is the difference signal. Collapse the side chain rack and never think about it. This effect&amp;rsquo;s final utility gain is 100% dry at 0 dB (if the difference signal is left unmodified).&lt;/p&gt;

&lt;p&gt;One thing is missing from these: it&amp;rsquo;s really nice to be able to apply effects to the original signal after we&amp;rsquo;ve used it to produce a difference signal but before we&amp;rsquo;ve summed them back together. To do that, put another empty effect rack in the A (positive) or B (negative) chain, and use the side chain audition to tap that rack pre-fx. Now, anything before the emtpy rack gets differenced, and anything after only gets sent to the output.&lt;/p&gt;

&lt;p&gt;I think you should figure out recreating this for yourself, or even find your own solution, because keeping track of what signal you&amp;rsquo;re producing and what needs to be inverted at what point in the signal chain is informative. My early attempts weren&amp;rsquo;t pretty. But if you&amp;rsquo;d rather just use mine, here&amp;rsquo;s &lt;a href=&#34;https://graemephi.github.io/posts/dumb-tricks-with-phase-inversion/Difference (Positive).adg&#34;&gt;Difference (Positive)&lt;/a&gt; and &lt;a href=&#34;https://graemephi.github.io/posts/dumb-tricks-with-phase-inversion/Difference (Negative).adg&#34;&gt;Difference (Negative)&lt;/a&gt; (Live 10. I don&amp;rsquo;t know if these things are backwards compatible, but I don&amp;rsquo;t use any features that are 10 only).&lt;/p&gt;
&lt;div class=&#34;footnotes&#34;&gt;

&lt;hr /&gt;

&lt;ol&gt;
&lt;li id=&#34;fn:1&#34;&gt;The process for finding the frequency content of a signal, the fourier transform, &lt;a href=&#34;https://math.stackexchange.com/questions/140788/how-is-the-fourier-transform-linear&#34;&gt;is linear&lt;/a&gt;.
 &lt;a class=&#34;footnote-return&#34; href=&#34;#fnref:1&#34;&gt;&lt;sup&gt;[return]&lt;/sup&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li id=&#34;fn:2&#34;&gt;One thing I&amp;rsquo;m taking for granted here is that plugins correctly report the delay they introduce to the signal chain. It&amp;rsquo;s hard to write a compressor people want to use without knowing exactly how much delay you&amp;rsquo;re inserting into the signal chain, but equalisers and filters can introduce frequency-specific delays. I couldn&amp;rsquo;t say how common or uncommon it is for plugins to handle this properly. All this still works, but the difference signal contains information you don&amp;rsquo;t want it to contain. Then again, if a filter is messing with the phase of your audio, it&amp;rsquo;s already screwing up your audio! You don&amp;rsquo;t care about theoretical correctness if you&amp;rsquo;re still using that filter.
 &lt;a class=&#34;footnote-return&#34; href=&#34;#fnref:2&#34;&gt;&lt;sup&gt;[return]&lt;/sup&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
    </item>
    
  </channel>
</rss>
